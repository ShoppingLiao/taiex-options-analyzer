<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>çµç®—æ—¥é æ¸¬å ±å‘Š - {{ settlement_date }}</title>
    <style>
        :root {
            --primary-color: #2563eb;
            --success-color: #22c55e;
            --warning-color: #f59e0b;
            --danger-color: #ef4444;
            --purple-color: #8b5cf6;
            --bg-color: #f8fafc;
            --card-bg: #ffffff;
            --text-color: #1e293b;
            --text-muted: #64748b;
            --border-color: #e2e8f0;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: var(--text-color);
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px 0;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        @media (max-width: 768px) {
            .container {
                padding: 0 12px;
            }
        }

        /* Header */
        header {
            background: linear-gradient(135deg, var(--primary-color), #1d4ed8);
            color: white;
            padding: 30px 20px;
            margin-bottom: 30px;
            border-radius: 12px;
            position: relative;
        }

        h1 {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .settlement-info {
            display: flex;
            gap: 30px;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 2px solid rgba(255, 255, 255, 0.2);
        }

        .info-item {
            flex: 1;
        }

        .info-label {
            font-size: 0.85rem;
            opacity: 0.8;
            margin-bottom: 5px;
        }

        .info-value {
            font-size: 1.3rem;
            font-weight: 700;
        }

        @media (max-width: 768px) {
            header {
                text-align: center;
            }
            
            h1 {
                font-size: 1.5rem;
            }
            .settlement-info {
                flex-direction: column;
                gap: 15px;
            }
        }

        /* Section */
        .section {
            background: white;
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        @media (max-width: 768px) {
            .section {
                padding: 20px 16px;
            }
        }

        .section-header {
            display: flex;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--border-color);
        }

        .section-icon {
            font-size: 1.8rem;
            margin-right: 12px;
        }

        .section-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-color);
        }

        /* Trend Overview */
        .trend-overview {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        @media (max-width: 768px) {
            .trend-overview {
                grid-template-columns: 1fr;
                gap: 20px;
            }
        }

        .trend-indicator {
            background: linear-gradient(135deg, var(--primary-color), #1d4ed8);
            color: white;
            border-radius: 12px;
            padding: 30px;
            text-align: center;
        }

        .trend-indicator.bullish {
            background: linear-gradient(135deg, var(--success-color), #16a34a);
        }

        .trend-indicator.bearish {
            background: linear-gradient(135deg, var(--danger-color), #dc2626);
        }

        .trend-indicator.neutral {
            background: linear-gradient(135deg, var(--warning-color), #d97706);
        }

        .trend-label {
            font-size: 0.9rem;
            opacity: 0.9;
            margin-bottom: 10px;
        }

        .trend-value {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .trend-strength {
            font-size: 1rem;
            opacity: 0.9;
        }

        .strength-stars {
            margin-top: 10px;
            font-size: 1.5rem;
        }

        /* Predicted Range */
        .predicted-range {
            background: linear-gradient(135deg, #f8fafc, #e2e8f0);
            border-radius: 12px;
            padding: 25px;
        }

        .range-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-muted);
            margin-bottom: 15px;
        }

        .range-display {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary-color);
        }

        .range-separator {
            color: var(--text-muted);
        }

        .current-price-badge {
            background: white;
            border: 2px solid var(--primary-color);
            border-radius: 8px;
            padding: 10px 20px;
            margin-top: 15px;
            text-align: center;
        }

        .current-price-label {
            font-size: 0.85rem;
            color: var(--text-muted);
        }

        .current-price-value {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--primary-color);
        }

        /* Trend Signals */
        .signals-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
        }

        .signal-card {
            background: var(--bg-color);
            border-radius: 12px;
            padding: 20px;
            border-left: 4px solid var(--primary-color);
        }

        .signal-card.bullish {
            border-left-color: var(--success-color);
        }

        .signal-card.bearish {
            border-left-color: var(--danger-color);
        }

        .signal-card.neutral {
            border-left-color: var(--warning-color);
        }

        .signal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .signal-direction {
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
        }

        .signal-strength {
            background: white;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .signal-indicators {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin-bottom: 10px;
        }

        .indicator-tag {
            background: white;
            color: var(--text-muted);
            padding: 3px 10px;
            border-radius: 6px;
            font-size: 0.75rem;
        }

        .signal-description {
            color: var(--text-color);
            font-size: 0.95rem;
            line-height: 1.5;
        }

        /* Scenarios */
        .scenarios-grid {
            display: grid;
            gap: 20px;
        }

        .scenario-card {
            background: var(--bg-color);
            border-radius: 12px;
            padding: 25px;
            border: 2px solid transparent;
            transition: all 0.3s;
        }

        .scenario-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
        }

        .scenario-card.primary {
            border-color: var(--primary-color);
            background: linear-gradient(135deg, #eff6ff, #dbeafe);
        }

        .scenario-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .scenario-name {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.3rem;
            font-weight: 700;
        }

        .scenario-icon {
            font-size: 1.8rem;
        }

        .scenario-probability {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-color);
        }

        .scenario-range {
            background: white;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .range-label {
            font-size: 0.85rem;
            color: var(--text-muted);
            margin-bottom: 5px;
        }

        .range-values {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--text-color);
        }

        .key-levels {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 15px;
        }

        .level-badge {
            background: white;
            border: 1px solid var(--border-color);
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 0.9rem;
            font-weight: 600;
        }

        .conditions-list {
            background: white;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .condition-item {
            padding: 6px 0;
            font-size: 0.9rem;
            color: var(--text-color);
        }

        .strategy-box {
            background: linear-gradient(135deg, #fef3c7, #fde68a);
            border-radius: 8px;
            padding: 15px;
            border-left: 3px solid var(--warning-color);
        }

        .strategy-label {
            font-size: 0.85rem;
            font-weight: 600;
            color: #92400e;
            margin-bottom: 5px;
        }

        .strategy-text {
            color: #78350f;
            font-size: 0.95rem;
        }

        /* Key Metrics */
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .metric-card {
            background: var(--bg-color);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
        }

        .metric-label {
            font-size: 0.85rem;
            color: var(--text-muted);
            margin-bottom: 10px;
        }

        .metric-value {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--text-color);
        }

        .metric-change {
            font-size: 0.9rem;
            margin-top: 5px;
        }

        .metric-change.positive {
            color: var(--success-color);
        }

        .metric-change.negative {
            color: var(--danger-color);
        }

        /* Risks */
        .risks-list {
            display: grid;
            gap: 12px;
        }

        .risk-item {
            background: #fef2f2;
            border-left: 4px solid var(--danger-color);
            border-radius: 8px;
            padding: 15px 20px;
            font-size: 0.95rem;
            color: #991b1b;
        }

        /* Header å›é¦–é æŒ‰éˆ• */
        .home-button {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            padding: 10px 20px;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .home-button:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        /* æ‰‹æ©Ÿç‰ˆèª¿æ•´ */
        @media (max-width: 768px) {
            .home-button {
                position: static;
                display: inline-flex;
                margin-top: 15px;
            }
        }

        /* Footer */
        footer {
            background: white;
            border-radius: 16px;
            padding: 20px;
            text-align: center;
            color: var(--text-muted);
            font-size: 0.9rem;
            margin-top: 30px;
        }

        .footer-links {
            margin-top: 10px;
        }

        .footer-links a {
            color: var(--primary-color);
            text-decoration: none;
            margin: 0 10px;
            transition: all 0.3s;
        }

        .footer-links a:hover {
            text-decoration: underline;
        }

        /* Tabs */
        .tabs-container {
            background: white;
            border-radius: 16px;
            padding: 0;
            margin-bottom: 30px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .tabs-header {
            display: flex;
            border-bottom: 2px solid var(--border-color);
            background: var(--bg-color);
        }

        .tab-button {
            flex: 1;
            padding: 18px 24px;
            background: transparent;
            border: none;
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-muted);
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
        }

        .tab-button:hover {
            background: rgba(37, 99, 235, 0.05);
            color: var(--primary-color);
        }

        .tab-button.active {
            color: var(--primary-color);
            background: white;
        }

        .tab-button.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--primary-color);
        }

        .tab-icon {
            margin-right: 8px;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        @media (max-width: 768px) {
            .tabs-header {
                flex-direction: column;
            }
            .tab-button {
                padding: 14px 20px;
                font-size: 1rem;
            }
        }

        /* AI Analysis Styles */
        .ai-intro {
            background: linear-gradient(135deg, #f0f9ff, #e0f2fe);
            border-left: 4px solid var(--primary-color);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 30px;
        }

        .ai-persona {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .ai-avatar {
            font-size: 3rem;
        }

        .ai-role {
            flex: 1;
        }

        .ai-role-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 5px;
        }

        .ai-role-desc {
            font-size: 0.95rem;
            color: var(--text-muted);
        }

        .ai-note {
            background: white;
            border-radius: 8px;
            padding: 15px;
            font-size: 0.95rem;
            line-height: 1.7;
            color: var(--text-color);
        }

        .analysis-section {
            margin-bottom: 30px;
        }

        .analysis-title {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--text-color);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--border-color);
        }

        .analysis-block {
            background: var(--bg-color);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
        }

        .block-title {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .block-content {
            font-size: 1rem;
            line-height: 1.8;
            color: var(--text-color);
        }

        .block-content p {
            margin-bottom: 15px;
        }

        .highlight-box {
            background: linear-gradient(135deg, #fef3c7, #fde68a);
            border-left: 4px solid var(--warning-color);
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
        }

        .highlight-box strong {
            color: #92400e;
        }

        .conclusion-box {
            background: linear-gradient(135deg, #dbeafe, #bfdbfe);
            border-left: 4px solid var(--primary-color);
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
        }

        .conclusion-box strong {
            color: #1e40af;
        }

        .price-levels {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }

        .price-level {
            background: white;
            border-radius: 8px;
            padding: 15px;
            border-left: 3px solid;
        }

        .price-level.resistance {
            border-left-color: var(--danger-color);
        }

        .price-level.support {
            border-left-color: var(--success-color);
        }

        .level-label {
            font-size: 0.85rem;
            font-weight: 600;
            margin-bottom: 8px;
            text-transform: uppercase;
        }

        .level-range {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .level-desc {
            font-size: 0.9rem;
            color: var(--text-muted);
            line-height: 1.5;
        }

        .trading-tips {
            background: linear-gradient(135deg, #fef2f2, #fee2e2);
            border-radius: 12px;
            padding: 25px;
            margin-top: 20px;
        }

        .tips-title {
            font-size: 1.2rem;
            font-weight: 700;
            color: #991b1b;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .tip-item {
            background: white;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 12px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        .tip-item strong {
            color: #991b1b;
        }

        .scenario-prediction {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .prediction-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            border: 2px solid var(--border-color);
            transition: all 0.3s;
        }

        .prediction-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
        }

        .prediction-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .prediction-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--text-color);
        }

        .prediction-prob {
            background: var(--primary-color);
            color: white;
            padding: 5px 12px;
            border-radius: 12px;
            font-size: 0.9rem;
            font-weight: 700;
        }

        .prediction-detail {
            font-size: 0.95rem;
            line-height: 1.7;
            color: var(--text-color);
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header>
            <a href="index.html" class="home-button">
                <span>ğŸ </span>
                <span>å›é¦–é </span>
            </a>
            <h1>ğŸ¯ çµç®—æ—¥é æ¸¬å ±å‘Š</h1>
            <p class="subtitle">Taiwan Stock Index Options Settlement Prediction</p>
            
            <div class="settlement-info">
                <div class="info-item">
                    <div class="info-label">çµç®—æ—¥æœŸ</div>
                    <div class="info-value">{{ settlement_date_formatted }}</div>
                </div>
                <div class="info-item">
                    <div class="info-label">åˆ†ææ•¸æ“š</div>
                    <div class="info-value">{{ analysis_dates_text }}</div>
                </div>
                <div class="info-item">
                    <div class="info-label">å ±å‘Šç”Ÿæˆ</div>
                    <div class="info-value">{{ generated_time }}</div>
                </div>
            </div>
        </header>

        <!-- Tabs -->
        <div class="tabs-container">
            <div class="tabs-header">
                <button class="tab-button active" onclick="switchTab('technical')">
                    <span class="tab-icon">ğŸ“Š</span>æŠ€è¡“åˆ†æ
                </button>
                <button class="tab-button" onclick="switchTab('ai-analysis')">
                    <span class="tab-icon">ğŸ¤–</span>AI æ“ç›¤åˆ†æ
                </button>
                <button class="tab-button" onclick="switchTab('trader-view')">
                    <span class="tab-icon">ğŸ§‘â€ğŸ’¼</span>äº¤æ˜“å“¡è¦–è§’
                </button>
                <button class="tab-button" onclick="switchTab('settlement-review')">
                    <span class="tab-icon">ğŸ“</span>ç›¤å¾Œæª¢è¨
                </button>
            </div>
        </div>

        <!-- Technical Analysis Tab -->
        <div id="technical-tab" class="tab-content active">
        
        <!-- Trend Overview -->
        <div class="section">
            <div class="section-header">
                <span class="section-icon">ğŸ“Š</span>
                <h2 class="section-title">è¶¨å‹¢åˆ†æç¸½è¦½</h2>
            </div>
            
            <div class="trend-overview">
                <div class="trend-indicator {{ overall_trend }}">
                    <div class="trend-label">æ•´é«”è¶¨å‹¢</div>
                    <div class="trend-value">{{ overall_trend_text }}</div>
                    <div class="trend-strength">å¼·åº¦è©•ç´š</div>
                    <div class="strength-stars">{{ strength_stars }}</div>
                </div>
                
                <div class="predicted-range">
                    <div class="range-title">é æ¸¬çµç®—å€é–“</div>
                    <div class="range-display">
                        <span>{{ predicted_lower }}</span>
                        <span class="range-separator">ï½</span>
                        <span>{{ predicted_upper }}</span>
                    </div>
                    <div class="current-price-badge">
                        <div class="current-price-label">ç•¶å‰åƒ¹æ ¼</div>
                        <div class="current-price-value">{{ current_price }}</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Trend Signals -->
        <div class="section">
            <div class="section-header">
                <span class="section-icon">ğŸ“¡</span>
                <h2 class="section-title">è¶¨å‹¢è¨Šè™Ÿåˆ†æ</h2>
            </div>
            
            <div class="signals-grid">
                {% for signal in trend_signals %}
                <div class="signal-card {{ signal.direction }}">
                    <div class="signal-header">
                        <div class="signal-direction">
                            <span>{{ signal.direction_icon }}</span>
                            <span>{{ signal.direction_text }}</span>
                        </div>
                        <div class="signal-strength">{{ signal.strength }}/5</div>
                    </div>
                    <div class="signal-indicators">
                        {% for indicator in signal.indicators %}
                        <span class="indicator-tag">{{ indicator }}</span>
                        {% endfor %}
                    </div>
                    <div class="signal-description">{{ signal.description }}</div>
                </div>
                {% endfor %}
            </div>
        </div>

        <!-- Scenarios -->
        <div class="section">
            <div class="section-header">
                <span class="section-icon">ğŸ¬</span>
                <h2 class="section-title">çµç®—åŠ‡æœ¬åˆ†æ</h2>
            </div>
            
            <div class="scenarios-grid">
                {% for scenario in scenarios %}
                <div class="scenario-card {% if loop.index == 1 %}primary{% endif %}">
                    <div class="scenario-header">
                        <div class="scenario-name">
                            <span class="scenario-icon">{{ scenario.icon }}</span>
                            <span>{{ scenario.name }}</span>
                        </div>
                        <div class="scenario-probability">{{ scenario.probability }}%</div>
                    </div>
                    
                    <div class="scenario-range">
                        <div class="range-label">é æ¸¬å€é–“</div>
                        <div class="range-values">{{ scenario.range_lower }} ï½ {{ scenario.range_upper }}</div>
                    </div>
                    
                    <div class="range-label">é—œéµåƒ¹ä½</div>
                    <div class="key-levels">
                        {% for level in scenario.key_levels %}
                        <span class="level-badge">{{ level }}</span>
                        {% endfor %}
                    </div>
                    
                    <div class="conditions-list">
                        <div class="range-label">æˆç«‹æ¢ä»¶</div>
                        {% for condition in scenario.conditions %}
                        <div class="condition-item">{{ condition }}</div>
                        {% endfor %}
                    </div>
                    
                    <div class="strategy-box">
                        <div class="strategy-label">ğŸ’¡ æ“ä½œå»ºè­°</div>
                        <div class="strategy-text">{{ scenario.strategy }}</div>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>

        <!-- Key Metrics -->
        <div class="section">
            <div class="section-header">
                <span class="section-icon">ğŸ“ˆ</span>
                <h2 class="section-title">é—œéµæŒ‡æ¨™</h2>
            </div>
            
            <div class="metrics-grid">
                {% for metric in key_metrics %}
                <div class="metric-card">
                    <div class="metric-label">{{ metric.label }}</div>
                    <div class="metric-value">{{ metric.value }}</div>
                    {% if metric.change %}
                    <div class="metric-change {{ metric.change_class }}">{{ metric.change }}</div>
                    {% endif %}
                </div>
                {% endfor %}
            </div>
        </div>

        <!-- Risks -->
        {% if risks %}
        <div class="section">
            <div class="section-header">
                <span class="section-icon">âš ï¸</span>
                <h2 class="section-title">é¢¨éšªæç¤º</h2>
            </div>
            
            <div class="risks-list">
                {% for risk in risks %}
                <div class="risk-item">{{ risk }}</div>
                {% endfor %}
            </div>
        </div>
        {% endif %}

        </div>
        <!-- End Technical Analysis Tab -->

        <!-- AI Analysis Tab -->
        <div id="ai-analysis-tab" class="tab-content">
            
            <!-- AI Persona Introduction -->
            <div class="section">
                <div class="ai-intro">
                    <div class="ai-persona">
                        <div class="ai-avatar">ğŸ‘¨â€ğŸ’¼</div>
                        <div class="ai-role">
                            <div class="ai-role-title">è³‡æ·±é¸æ“‡æ¬Šæ“ç›¤æ‰‹è¦–è§’</div>
                            <div class="ai-role-desc">20å¹´å¯¦æˆ°ç¶“é©— | å°ˆæ³¨å°æŒ‡é¸æ“‡æ¬Šçµç®—æ—¥ç­–ç•¥</div>
                        </div>
                    </div>
                    <div class="ai-note">
                        <strong>ç¬¬ä¸€äººç¨±è¦–è§’ï¼š</strong>æˆ‘æ˜¯ä¸€ä½è€ç·´çš„é¸æ“‡æ¬Šæ“ç›¤æ‰‹ï¼Œä»¥ä¸‹æ˜¯æˆ‘å°æœ¬æ¬¡çµç®—æ—¥çš„æ·±åº¦åˆ†æã€‚é€™ä¸åªæ˜¯å†·å†°å†°çš„æ•¸æ“šï¼Œè€Œæ˜¯æˆ‘å¤šå¹´ä¾†åœ¨å¸‚å ´å»æ®ºç´¯ç©çš„å¯¦æˆ°ç¶“é©—èˆ‡åˆ¤æ–·ã€‚
                    </div>
                </div>
            </div>

            <!-- Settlement Range Analysis -->
            <div class="section">
                <div class="analysis-section">
                    <h3 class="analysis-title">
                        <span>ğŸ¯</span>çµç®—å€é–“é æ¸¬ï¼šèŠå®¶çš„ã€Œæœ€ä½³åˆ©ç›Šé»ã€
                    </h3>

                    <div class="analysis-block">
                        <div class="block-content">
                            <p>æ ¹æ“šç›®å‰çš„ OI ç±Œç¢¼åœ–å’Œå¤œç›¤èµ°å‹¢ï¼Œæˆ‘çœ‹åˆ°äº†èŠå®¶ï¼ˆè³£æ–¹ï¼‰éå¸¸æ¸…æ™°çš„é˜²ç·šå¸ƒå±€ã€‚åœ¨çµç®—æ—¥é€™ç¨®é—œéµæ™‚åˆ»ï¼Œå¸‚å ´ä¸æ˜¯éš¨æ©ŸéŠèµ°ï¼Œè€Œæ˜¯ä¸€å ´å¤šç©ºé›™æ–¹çš„ç±Œç¢¼åšå¼ˆã€‚</p>
                        </div>
                    </div>

                    <div class="price-levels">
                        <div class="price-level resistance">
                            <div class="level-label" style="color: var(--danger-color);">ğŸ”´ ä¸Šæª”å¤©èŠ±æ¿</div>
                            <div class="level-range">{{ ai_resistance_range }}</div>
                            <div class="level-desc">
                                å¤œç›¤é«˜é» {{ night_high }} æ¥è¿‘å£“åŠ›å€ä¾¿æ‹‰å›ï¼Œé€™å°è­‰äº† Call OI å¤§å¢çš„å£“åˆ¶åŠ›ã€‚<strong>é™¤éæ—©ç›¤æœ‰æ¥µå¤§åˆ©å¤šï¼Œå¦å‰‡è¦çµç®—åœ¨æ­¤ä¹‹ä¸Šçš„æ©Ÿç‡è¼ƒä½</strong>ï¼Œå› ç‚ºèŠå®¶æœƒå…¨åŠ›å®ˆä½é€™é“é˜²ç·šä»¥è³ºå– Call çš„æ¬Šåˆ©é‡‘ã€‚
                            </div>
                        </div>

                        <div class="price-level support">
                            <div class="level-label" style="color: var(--success-color);">ğŸŸ¢ ä¸‹æª”åœ°æ¿</div>
                            <div class="level-range">{{ ai_support_range }}</div>
                            <div class="level-desc">
                                å¤œç›¤ä½é» {{ night_low }} å®ˆåœ¨æ­¤é—œå¡ä¹‹ä¸Šï¼Œè·é›¢ Put OI é‡å…µå€å°šæœ‰ç©ºé–“ã€‚<strong>æ­¤ä½é™„è¿‘æœ‰æ”¯æ’</strong>ï¼Œè‹¥ä»Šæ—¥å›æ¸¬æ­¤ä½ï¼Œé€šå¸¸æœƒæœ‰è²·ç›¤æˆ–èŠå®¶è­·ç›¤ã€‚
                            </div>
                        </div>
                    </div>

                    <div class="conclusion-box">
                        <strong>æˆ‘çš„åˆ¤æ–·ï¼š</strong>çµç®—åƒ¹é«˜æ©Ÿç‡è½åœ¨ <strong>{{ ai_settlement_range }}</strong> é€™å€‹å€é–“ï¼Œè®“å…©é‚Šçš„æ¬Šåˆ©é‡‘æœ€å¤§ç¨‹åº¦è¢«æ¶ˆè€—ã€‚é€™æ˜¯èŠå®¶çš„æœ€ä½³åˆ©ç›Šé»ã€‚
                    </div>
                </div>
            </div>

            <!-- P/C Ratio Analysis -->
            <div class="section">
                <div class="analysis-section">
                    <h3 class="analysis-title">
                        <span>ğŸ“‰</span>P/C Ratio è½‰å¼±çš„å¯¦æˆ°æ„ç¾©
                    </h3>

                    <div class="analysis-block">
                        <div class="block-content">
                            <p>æ˜¨å¤©çš„ P/C Ratio é¡¯ç¤º <strong>{{ pc_ratio_status }}</strong>ï¼Œé…åˆå¤œç›¤ {{ night_trend }}ï¼Œé€™ä»£è¡¨ï¼š</p>
                            
                            <div class="highlight-box">
                                <p><strong>âœ“ å¸‚å ´è¿½åƒ¹æ„é¡˜ {{ chase_willingness }}</strong></p>
                                <p><strong>âœ“ ä»Šå¤©èµ°å‹¢é«˜æ©Ÿç‡æ˜¯ã€Œ{{ expected_pattern }}ã€</strong></p>
                                <p>ç›®çš„æ˜¯è®“é¸æ“‡æ¬Šçš„æ¬Šåˆ©é‡‘ï¼ˆIVï¼‰é›™æ®ºï¼Œå›æ­¸åˆ°èŠå®¶è¨­å®šçš„å€é–“ã€‚</p>
                            </div>

                            <p>é€™ç¨®æƒ…æ³ä¸‹ï¼Œæˆ‘ä¸æœƒè²¿ç„¶è¿½é«˜æˆ–æ¶çŸ­ï¼Œè€Œæ˜¯è€å¿ƒç­‰å¾…èŠå®¶éœ²å‡ºåº•ç‰Œã€‚</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Intraday Observation -->
            <div class="section">
                <div class="analysis-section">
                    <h3 class="analysis-title">
                        <span>ğŸ‘€</span>ä»Šæ—¥ ({{ settlement_date }}) æ“ä½œè§€å¯Ÿé‡é»
                    </h3>

                    <div class="scenario-prediction">
                        <div class="prediction-card">
                            <div class="prediction-header">
                                <div class="prediction-title">ğŸ”” é–‹ç›¤ä½éš</div>
                            </div>
                            <div class="prediction-detail">
                                è‹¥é–‹åœ¨ <strong>{{ opening_ref_price }}</strong> é™„è¿‘ï¼Œä»£è¡¨å¤šç©ºå¹³è¡¡ã€‚<br><br>
                                <strong>åé«˜é–‹ï¼š</strong>æ³¨æ„æ˜¯å¦ç‚ºèª˜å¤šï¼Œè§€å¯Ÿ 30 åˆ†é˜å…§èƒ½å¦å®ˆä½ã€‚<br>
                                <strong>åä½é–‹ï¼š</strong>ç•™æ„æ˜¯å¦æ¸¬è©¦æ”¯æ’å¾Œåå½ˆã€‚
                            </div>
                        </div>

                        <div class="prediction-card">
                            <div class="prediction-header">
                                <div class="prediction-title">â° æœ€å¾Œ 30 åˆ†é˜</div>
                                <div class="prediction-prob">é—œéµæ™‚åˆ»</div>
                            </div>
                            <div class="prediction-detail">
                                <strong>13:00 - 13:30</strong><br><br>
                                å°æŒ‡çµç®—åƒ¹æ˜¯æ¡<strong>ç¾è²¨æœ€å¾ŒåŠå°æ™‚çš„å¹³å‡åƒ¹</strong>ã€‚<br><br>
                                å¦‚æœåƒ¹æ ¼æ¥è¿‘ {{ key_strike_price }}ï¼ŒèŠå®¶å¯èƒ½æœƒè©¦åœ–å°‡åƒ¹æ ¼å£“åœ¨æ­¤ä¹‹ä¸‹æˆ–æ‹‰ä¸Šæ­¤ä½ï¼Œä»¥æ±ºå®šå“ªäº›å±¥ç´„åƒ¹çš„é¸æ“‡æ¬Šæœƒæ­¸é›¶ã€‚
                            </div>
                        </div>

                        <div class="prediction-card">
                            <div class="prediction-header">
                                <div class="prediction-title">ğŸ² é æœŸçµç®—åƒ¹</div>
                                <div class="prediction-prob">é«˜æ©Ÿç‡</div>
                            </div>
                            <div class="prediction-detail">
                                è½åœ¨ <strong>{{ ai_settlement_range }}</strong><br><br>
                                é€™å€‹å€é–“è®“èŠå®¶å…©é‚Šçš„æ¬Šåˆ©é‡‘æ”¶ç›Šæœ€å¤§åŒ–ï¼ŒåŒæ™‚é¿å…å–®é‚Šå‡ºç¾éå¤§å±¥ç´„å£“åŠ›ã€‚
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Trading Tips -->
            <div class="section">
                <div class="trading-tips">
                    <div class="tips-title">
                        <span>ğŸ’¡</span>å¯¦æˆ°å°å®åš€
                    </div>

                    <div class="tip-item">
                        <strong>æ™‚é–“åƒ¹å€¼æµé€åŠ é€Ÿï¼š</strong><br>
                        å› ç‚º IVï¼ˆéš±å«æ³¢å‹•ç‡ï¼‰æ˜¨å¤©æ˜¯ä¸Šå‡çš„ï¼Œé€™ä»£è¡¨ä»Šå¤©å³ä¾¿æŒ‡æ•¸ä¸å‹•ï¼Œé¸æ“‡æ¬Šçš„åƒ¹æ ¼ä¹Ÿæœƒå› ç‚ºã€Œæ™‚é–“åƒ¹å€¼æµé€ã€èˆ‡ã€Œæ³¢å‹•ç‡å›è½ã€è€Œç¸®æ°´å¾ˆå¿«ã€‚çµç®—æ—¥çš„ Theta Decayï¼ˆæ™‚é–“åƒ¹å€¼è¡°æ¸›ï¼‰æ˜¯æœ€å…‡çŒ›çš„ã€‚
                    </div>

                    <div class="tip-item">
                        <strong>å¦‚æœæ‚¨æ‰‹ä¸Šæœ‰ {{ contract_month }} è¿‘æœˆéƒ¨ä½ï¼š</strong><br>
                        å»ºè­°æ—©ç›¤è‹¥æœ‰è¡é«˜è‡³ <strong>{{ exit_level_high }}</strong> ä»¥ä¸Šï¼Œå¯è€ƒæ…®å…ˆè¡Œå¹³å€‰ï¼Œä¸ä¸€å®šè¦è³­åˆ°æœ€å¾Œçµç®—ã€‚å› ç‚ºèŠå®¶å®ˆ {{ resistance_key_level }} çš„æ±ºå¿ƒå¾ˆå¼·ï¼Œç¹¼çºŒæŒæœ‰é¢¨éšªå ±é…¬æ¯”ä¸åˆ’ç®—ã€‚
                    </div>

                    <div class="tip-item">
                        <strong>å¦‚æœæ‚¨æƒ³é€²å ´ï¼š</strong><br>
                        çµç®—æ—¥ç•¶å¤©ç•¶æ²–é¢¨éšªè¼ƒå¤§ï¼Œå»ºè­°è§€å¯Ÿçµç®—å¾Œçš„<strong>æ–°æœˆä»½ï¼ˆ{{ next_month_1 }} å…¨æœˆæˆ– {{ next_month_2 }}ï¼‰</strong>ç±Œç¢¼é‡æ–°å¸ƒå±€ã€‚æ–°æœˆä»½çš„ OI åˆ†å¸ƒæœƒæ›´æ¸…æ™°åœ°åæ˜ å¸‚å ´å°æœªä¾†èµ°å‹¢çš„é æœŸã€‚
                    </div>

                    <div class="tip-item">
                        <strong>ç•™æ„é»‘å¤©éµäº‹ä»¶ï¼š</strong><br>
                        é›–ç„¶ç±Œç¢¼é¢çµ¦å‡ºæ˜ç¢ºçš„å€é–“é æ¸¬ï¼Œä½†è‹¥å‡ºç¾é‡å¤§åœ‹éš›æ¶ˆæ¯ï¼ˆå¦‚ç¾è‚¡æš´æ¼²æš´è·Œã€åœ°ç·£æ”¿æ²»çªç™¼äº‹ä»¶ï¼‰ï¼Œä¸€åˆ‡æŠ€è¡“åˆ†æéƒ½æœƒå¤±æ•ˆã€‚<strong>å‹™å¿…è¨­å¥½åœæ</strong>ï¼Œä¸è¦éåº¦è‡ªä¿¡ã€‚
                    </div>
                </div>
            </div>

            <!-- Conclusion -->
            <div class="section">
                <div class="analysis-section">
                    <h3 class="analysis-title">
                        <span>ğŸ“</span>ç¸½çµï¼šæˆ‘çš„çµç®—æ—¥ç­–ç•¥
                    </h3>

                    <div class="analysis-block">
                        <div class="block-content">
                            <p style="font-size: 1.1rem; line-height: 1.9;">
                                ä½œç‚ºä¸€å€‹åœ¨å¸‚å ´æ‰“æ»¾å¤šå¹´çš„è€æ‰‹ï¼Œ<strong>æˆ‘ä¸æœƒåœ¨çµç®—æ—¥å†’éšªè¿½é«˜æ®ºä½</strong>ã€‚ä»Šå¤©çš„ç­–ç•¥å¾ˆç°¡å–®ï¼š
                            </p>

                            <div class="highlight-box">
                                <p><strong>1ï¸âƒ£ æŒå€‰éƒ¨ä½ï¼š</strong>çœ‹åˆ°æ¥è¿‘ä¸Šæª”å£“åŠ› {{ resistance_key_level }} å°±æ¸›ç¢¼ï¼Œè½è¢‹ç‚ºå®‰</p>
                                <p><strong>2ï¸âƒ£ æ–°é€²å ´ï¼š</strong>ç­‰çµç®—å¾Œå†èªªï¼Œä¸æ€¥æ–¼ä¸€æ™‚</p>
                                <p><strong>3ï¸âƒ£ è§€å¯Ÿé‡é»ï¼š</strong>æœ€å¾Œ 30 åˆ†é˜çš„åƒ¹æ ¼è¡Œç‚ºï¼Œé€™æœƒå‘Šè¨´æˆ‘ä¸‹å€‹æœˆçš„æ–¹å‘</p>
                            </div>

                            <p style="font-size: 1.1rem; margin-top: 20px;">
                                è¨˜ä½ï¼Œ<strong>å¸‚å ´æ°¸é æ˜¯å°çš„ï¼Œæˆ‘å€‘åªæ˜¯é †å‹¢è€Œç‚º</strong>ã€‚èŠå®¶å¸ƒä¸‹çš„ç±Œç¢¼é™·é˜±å·²ç¶“å¾ˆæ˜é¡¯äº†ï¼Œæˆ‘å€‘è¦åšçš„å°±æ˜¯ä¸è¦æˆç‚ºè¢«æ”¶å‰²çš„éŸ­èœã€‚ä¿è­·æœ¬é‡‘ï¼Œç­‰å¾…æ›´å¥½çš„æ©Ÿæœƒï¼Œé€™æ‰æ˜¯é•·æœŸç²åˆ©çš„ç‹é“ã€‚
                            </p>

                            <div class="conclusion-box" style="margin-top: 20px;">
                                <p style="font-size: 1.05rem;"><strong>ç¥å¤§å®¶æ“ä½œé †åˆ©ï¼Œçµç®—æ—¥å¹³å®‰ï¼</strong> ğŸ€</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
        <!-- End AI Analysis Tab -->

        <!-- Trader View Tab -->
        <div id="trader-view-tab" class="tab-content">
            {% if settlement_trader_analysis %}
            
            <!-- ç¶“é©—ç­‰ç´š & å­¸ç¿’é€²åº¦ -->
            <div style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 25px; border-radius: 12px; margin-bottom: 30px; box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);">
                <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 20px;">
                    <div>
                        <h2 style="margin: 0; font-size: 1.8rem;">{{ settlement_trader_analysis.level_icon }} AI äº¤æ˜“å“¡è¦–è§’</h2>
                        <p style="margin: 8px 0 0 0; opacity: 0.9;">ç¶“é©—ç­‰ç´š: {{ settlement_trader_analysis.experience_level }}</p>
                    </div>
                    <div style="text-align: right; background: rgba(255,255,255,0.1); padding: 15px 20px; border-radius: 8px; backdrop-filter: blur(10px);">
                        <div style="font-size: 0.9rem; opacity: 0.9; margin-bottom: 5px;">å­¸ç¿’é€²åº¦</div>
                        <div style="font-size: 1.1rem; font-weight: 600; white-space: pre-line;">{{ settlement_trader_analysis.learning_summary }}</div>
                    </div>
                </div>
            </div>

            <!-- é—œéµæ•¸æ“šæ¦‚è¦½ -->
            <div class="section">
                <div class="section-header">
                    <span class="section-icon">ğŸ“Š</span>
                    <h2 class="section-title">çµç®—æ—¥é—œéµæ•¸æ“š</h2>
                </div>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-top: 20px;">
                    <div style="background: white; padding: 20px; border-radius: 12px; text-align: center; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                        <div style="font-size: 0.9rem; color: var(--text-muted); margin-bottom: 8px;">çµç®—æ—¥æœŸ</div>
                        <div style="font-size: 1.5rem; font-weight: 700; color: var(--primary-color);">{{ settlement_date }}</div>
                    </div>
                    <div style="background: white; padding: 20px; border-radius: 12px; text-align: center; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                        <div style="font-size: 0.9rem; color: var(--text-muted); margin-bottom: 8px;">ç•¶å‰åƒ¹æ ¼</div>
                        <div style="font-size: 1.5rem; font-weight: 700; color: #10b981;">{{ current_price }}</div>
                    </div>
                    <div style="background: white; padding: 20px; border-radius: 12px; text-align: center; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                        <div style="font-size: 0.9rem; color: var(--text-muted); margin-bottom: 8px;">é æ¸¬å€é–“</div>
                        <div style="font-size: 1.3rem; font-weight: 700; color: var(--purple-color);">{{ predicted_lower }} - {{ predicted_upper }}</div>
                    </div>
                    <div style="background: white; padding: 20px; border-radius: 12px; text-align: center; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                        <div style="font-size: 0.9rem; color: var(--text-muted); margin-bottom: 8px;">è¶¨å‹¢å¼·åº¦</div>
                        <div style="font-size: 1.5rem; font-weight: 700;">{{ strength_stars }}</div>
                    </div>
                </div>
            </div>

            <!-- æˆ‘å°çµç®—æ—¥çš„çœ‹æ³•ï¼ˆç¬¬ä¸€äººç¨±ï¼‰ -->
            <div class="section">
                <div class="section-header">
                    <span class="section-icon">ğŸ‘ï¸</span>
                    <h2 class="section-title">æˆ‘å°çµç®—æ—¥çš„çœ‹æ³•</h2>
                </div>
                <div style="background: white; padding: 30px; border-radius: 12px; border-left: 4px solid var(--primary-color); box-shadow: 0 4px 12px rgba(0,0,0,0.08); line-height: 1.9; white-space: pre-wrap; font-size: 1.05rem;">{{ settlement_trader_analysis.settlement_outlook }}</div>
            </div>

            <!-- æˆ‘çš„çµç®—æ—¥ç­–ç•¥ï¼ˆç¬¬ä¸€äººç¨±ï¼‰ -->
            <div class="section">
                <div class="section-header">
                    <span class="section-icon">ğŸ¯</span>
                    <h2 class="section-title">æˆ‘çš„çµç®—æ—¥ç­–ç•¥</h2>
                </div>
                <div style="background: white; padding: 30px; border-radius: 12px; border-left: 4px solid #10b981; box-shadow: 0 4px 12px rgba(0,0,0,0.08); line-height: 1.9; white-space: pre-wrap; font-size: 1.05rem;">{{ settlement_trader_analysis.settlement_strategy }}</div>
            </div>

            <!-- æˆ‘æœ€æ“”å¿ƒçš„é¢¨éšªï¼ˆç¬¬ä¸€äººç¨±ï¼‰ -->
            <div class="section">
                <div class="section-header">
                    <span class="section-icon">âš ï¸</span>
                    <h2 class="section-title">æˆ‘æœ€æ“”å¿ƒçš„é¢¨éšª</h2>
                </div>
                <div style="background: #fef2f2; padding: 30px; border-radius: 12px; border-left: 4px solid #ef4444; box-shadow: 0 4px 12px rgba(0,0,0,0.08); line-height: 1.9; white-space: pre-wrap; font-size: 1.05rem;">{{ settlement_trader_analysis.settlement_risks }}</div>
            </div>

            <!-- æˆ‘çš„åŸ·è¡Œè¨ˆåŠƒï¼ˆç¬¬ä¸€äººç¨±ï¼‰ -->
            <div class="section">
                <div class="section-header">
                    <span class="section-icon">ğŸ“‹</span>
                    <h2 class="section-title">æˆ‘çš„åŸ·è¡Œè¨ˆåŠƒ</h2>
                </div>
                <div style="background: white; padding: 30px; border-radius: 12px; border-left: 4px solid #f59e0b; box-shadow: 0 4px 12px rgba(0,0,0,0.08); line-height: 1.9; white-space: pre-wrap; font-size: 1.05rem;">{{ settlement_trader_analysis.execution_plan }}</div>
            </div>

            <!-- éå¾€çµç®—æ—¥ç¶“é©— -->
            {% if settlement_trader_analysis.historical_insights %}
            <div class="section">
                <div class="section-header">
                    <span class="section-icon">ğŸ“š</span>
                    <h2 class="section-title">å¾éå¾€çµç®—æ—¥å­¸åˆ°çš„</h2>
                </div>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                    {% for insight in settlement_trader_analysis.historical_insights %}
                    <div style="background: linear-gradient(135deg, #fef3c7, #fde68a); padding: 25px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.08);">
                        <p style="margin: 0; font-style: italic; font-size: 1.05rem; line-height: 1.7;">ğŸ’¡ {{ insight }}</p>
                    </div>
                    {% endfor %}
                </div>
            </div>
            {% endif %}

            <!-- ç›¸ä¼¼æ¡ˆä¾‹åƒè€ƒ -->
            {% if settlement_trader_analysis.similar_cases > 0 %}
            <div style="margin-top: 20px; padding: 25px; background: #f0fdf4; border-radius: 12px; border: 2px solid #86efac; box-shadow: 0 4px 12px rgba(0,0,0,0.08);">
                <p style="margin: 0; color: #166534; font-size: 1.1rem;">
                    ğŸ“Š åœ¨æˆ‘çš„è¨˜æ†¶ä¸­ï¼Œæ‰¾åˆ° <strong style="font-size: 1.3rem; color: #15803d;">{{ settlement_trader_analysis.similar_cases }}</strong> å€‹é¡ä¼¼çš„çµç®—æ—¥æƒ…å¢ƒå¯ä¾›åƒè€ƒ
                </p>
            </div>
            {% endif %}

            <!-- ç¸½çµèˆ‡æé†’ -->
            <div style="margin-top: 30px; padding: 30px; background: linear-gradient(135deg, #f3f4f6, #e5e7eb); border-radius: 12px; text-align: center; box-shadow: 0 4px 12px rgba(0,0,0,0.08);">
                <p style="font-style: italic; color: var(--text-muted); font-size: 1.05rem; line-height: 1.8;">
                    ğŸ§‘â€ğŸ’¼ ä»¥ä¸Šæ˜¯æˆ‘ä½œç‚º AI äº¤æ˜“å“¡å°é€™æ¬¡çµç®—æ—¥çš„å€‹äººçœ‹æ³•èˆ‡è¨ˆåŠƒ<br>
                    çµç®—æ—¥å¾€å¾€å……æ»¿è®Šæ•¸ï¼Œæˆ‘æœƒæŒçºŒè§€å¯Ÿå¸‚å ´ä¸¦éˆæ´»èª¿æ•´ç­–ç•¥<br>
                    <strong style="color: var(--danger-color);">è¨˜ä½ï¼šä¿è­·æœ¬é‡‘æ°¸é æ˜¯ç¬¬ä¸€å„ªå…ˆï¼</strong>
                </p>
            </div>

            {% else %}
            <div class="section">
                <div style="background: white; padding: 40px; border-radius: 12px; text-align: center; box-shadow: 0 4px 12px rgba(0,0,0,0.08);">
                    <p style="font-size: 1.2rem; color: var(--text-muted);">AI äº¤æ˜“å“¡è¦–è§’åŠŸèƒ½å°šæœªå•Ÿç”¨</p>
                </div>
            </div>
            {% endif %}
        </div>
        <!-- End Trader View Tab -->

        <!-- Settlement Review Tab -->
        <div id="settlement-review-tab" class="tab-content">
            
            <!-- AI Performance Overview -->
            {% if ai_performance and ai_performance.statistics.total_predictions > 0 %}
            <div class="section" style="background: linear-gradient(135deg, #dbeafe 0%, #3b82f6 100%);">
                <div class="section-header" style="border-bottom-color: rgba(30, 64, 175, 0.2);">
                    <span class="section-icon">ğŸ“ˆ</span>
                    <h2 class="section-title" style="color: #1e40af;">AI é æ¸¬ç¸¾æ•ˆç¸½è¦½</h2>
                </div>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 25px;">
                    <div style="background: rgba(255, 255, 255, 0.95); padding: 20px; border-radius: 12px; text-align: center; border-left: 4px solid #3b82f6;">
                        <div style="font-size: 0.85rem; color: #1e40af; margin-bottom: 8px; font-weight: 600;">ç¸½é æ¸¬æ¬¡æ•¸</div>
                        <div style="font-size: 2rem; font-weight: 700; color: #2563eb;">{{ ai_performance.statistics.total_predictions }}</div>
                        <div style="font-size: 0.75rem; color: #60a5fa; margin-top: 4px;">ç´¯ç©ç¶“é©—</div>
                    </div>
                    <div style="background: rgba(255, 255, 255, 0.95); padding: 20px; border-radius: 12px; text-align: center; border-left: 4px solid #10b981;">
                        <div style="font-size: 0.85rem; color: #065f46; margin-bottom: 8px; font-weight: 600;">å¹³å‡æº–ç¢ºåº¦</div>
                        <div style="font-size: 2rem; font-weight: 700; color: #059669;">{{ ai_performance.statistics.avg_accuracy }}%</div>
                        <div style="font-size: 0.75rem; color: #34d399; margin-top: 4px;">æ•´é«”è¡¨ç¾</div>
                    </div>
                    <div style="background: rgba(255, 255, 255, 0.95); padding: 20px; border-radius: 12px; text-align: center; border-left: 4px solid #f59e0b;">
                        <div style="font-size: 0.85rem; color: #92400e; margin-bottom: 8px; font-weight: 600;">å¹³å‡èª¤å·®</div>
                        <div style="font-size: 2rem; font-weight: 700; color: #d97706;">{{ ai_performance.statistics.avg_price_error|round(1) }}</div>
                        <div style="font-size: 0.75rem; color: #fbbf24; margin-top: 4px;">é»æ•¸</div>
                    </div>
                    <div style="background: rgba(255, 255, 255, 0.95); padding: 20px; border-radius: 12px; text-align: center; border-left: 4px solid #8b5cf6;">
                        <div style="font-size: 0.85rem; color: #5b21b6; margin-bottom: 8px; font-weight: 600;">å€é–“å‘½ä¸­ç‡</div>
                        <div style="font-size: 2rem; font-weight: 700; color: #7c3aed;">{{ ai_performance.statistics.range_success_rate }}%</div>
                        <div style="font-size: 0.75rem; color: #a78bfa; margin-top: 4px;">é æ¸¬ç²¾æº–åº¦</div>
                    </div>
                </div>
                
                <!-- Best Prediction -->
                {% if ai_performance.best_prediction %}
                <div style="background: rgba(255, 255, 255, 0.95); padding: 20px; border-radius: 12px; border: 2px solid #fbbf24;">
                    <h3 style="color: #92400e; margin-bottom: 15px; font-size: 1.1rem;">â­ æœ€ä½³é æ¸¬è¨˜éŒ„</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px;">
                        <div>
                            <div style="font-size: 0.8rem; color: #78716c; margin-bottom: 4px;">æ—¥æœŸ</div>
                            <div style="font-size: 1.1rem; font-weight: 600; color: #1c1917;">{{ ai_performance.best_prediction.date }}</div>
                        </div>
                        <div>
                            <div style="font-size: 0.8rem; color: #78716c; margin-bottom: 4px;">åƒ¹æ ¼èª¤å·®</div>
                            <div style="font-size: 1.1rem; font-weight: 600; color: #059669;">{{ ai_performance.best_prediction.price_error }} é»</div>
                        </div>
                        <div>
                            <div style="font-size: 0.8rem; color: #78716c; margin-bottom: 4px;">æº–ç¢ºåº¦</div>
                            <div style="font-size: 1.1rem; font-weight: 600; color: #2563eb;">{{ ai_performance.best_prediction.accuracy }}%</div>
                        </div>
                        <div>
                            <div style="font-size: 0.8rem; color: #78716c; margin-bottom: 4px;">è©•åˆ†</div>
                            <div style="font-size: 1.1rem; font-weight: 600; color: #7c3aed;">{{ ai_performance.best_prediction.score }}</div>
                        </div>
                    </div>
                </div>
                {% endif %}
            </div>
            {% endif %}
            
            <!-- AI Settlement Prediction -->
            {% if ai_settlement_prediction %}
            <div class="section" style="background: linear-gradient(135deg, #fef3c7 0%, #fbbf24 100%); color: #78350f;">
                <div class="section-header" style="border-bottom-color: rgba(120, 53, 15, 0.2);">
                    <span class="section-icon">ğŸ”®</span>
                    <h2 class="section-title" style="color: #78350f;">çµç®—æ—¥AIé æ¸¬ {{ ai_level_icon }}</h2>
                </div>
                
                <div style="background: rgba(255, 255, 255, 0.9); border-radius: 12px; padding: 25px; margin-bottom: 25px;">
                    <h3 style="color: #92400e; margin-bottom: 15px; font-size: 1.3rem;">ğŸ“Š è¶¨å‹¢åˆ†æ ({{ ai_settlement_prediction.settlement_weekday_zh }}çµç®—)</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px;">
                        <div style="background: white; padding: 15px; border-radius: 8px; border-left: 4px solid #f59e0b;">
                            <div style="font-size: 0.85rem; color: #78350f; margin-bottom: 5px;">è¶¨å‹¢æ–¹å‘</div>
                            <div style="font-size: 1.3rem; font-weight: 700; color: #92400e;">{{ ai_settlement_prediction.trend_analysis.trend_direction }}</div>
                        </div>
                        <div style="background: white; padding: 15px; border-radius: 8px; border-left: 4px solid #f59e0b;">
                            <div style="font-size: 0.85rem; color: #78350f; margin-bottom: 5px;">åƒ¹æ ¼è®ŠåŒ–</div>
                            <div style="font-size: 1.3rem; font-weight: 700; color: #92400e;">{{ ai_settlement_prediction.trend_analysis.price_change }}</div>
                        </div>
                        <div style="background: white; padding: 15px; border-radius: 8px; border-left: 4px solid #f59e0b;">
                            <div style="font-size: 0.85rem; color: #78350f; margin-bottom: 5px;">å‹•èƒ½è©•åˆ†</div>
                            <div style="font-size: 1.3rem; font-weight: 700; color: #92400e;">{{ ai_settlement_prediction.trend_analysis.momentum }}/10</div>
                        </div>
                    </div>
                </div>

                <div style="background: rgba(255, 255, 255, 0.9); border-radius: 12px; padding: 25px; margin-bottom: 25px;">
                    <h3 style="color: #92400e; margin-bottom: 15px; font-size: 1.3rem;">ğŸ¯ çµç®—åƒ¹é æ¸¬</h3>
                    <div style="text-align: center; margin-bottom: 20px;">
                        <div style="font-size: 2.5rem; font-weight: 700; color: #92400e; margin-bottom: 10px;">
                            {{ ai_settlement_prediction.settlement_price_prediction.predicted_price | format_number }} é»
                        </div>
                        <div style="font-size: 1.1rem; color: #78350f;">
                            é æ¸¬å€é–“: {{ ai_settlement_prediction.settlement_price_prediction.lower_bound | format_number }} - 
                            {{ ai_settlement_prediction.settlement_price_prediction.upper_bound | format_number }}
                        </div>
                        <div style="font-size: 0.95rem; color: #a16207; margin-top: 10px;">
                            é æœŸè®ŠåŒ–: {{ ai_settlement_prediction.settlement_price_prediction.expected_change }}
                        </div>
                    </div>
                </div>

                <div style="background: rgba(255, 255, 255, 0.9); border-radius: 12px; padding: 25px; margin-bottom: 25px;">
                    <h3 style="color: #92400e; margin-bottom: 15px; font-size: 1.3rem;">ğŸ“‹ æƒ…å¢ƒåˆ†æ</h3>
                    {% for scenario in ai_settlement_prediction.scenarios %}
                    <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 12px; border-left: 4px solid #f59e0b;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                            <span style="font-weight: 600; color: #92400e; font-size: 1.1rem;">{{ scenario.name }}</span>
                            <span style="background: #fef3c7; padding: 4px 12px; border-radius: 12px; font-weight: 600; color: #78350f;">
                                {{ scenario.probability }}%
                            </span>
                        </div>
                        <p style="color: #78350f; margin: 0;">{{ scenario.description }}</p>
                    </div>
                    {% endfor %}
                </div>

                <div style="background: rgba(255, 255, 255, 0.9); border-radius: 12px; padding: 25px; margin-bottom: 25px;">
                    <h3 style="color: #92400e; margin-bottom: 15px; font-size: 1.3rem;">ğŸ’¡ æˆ‘çš„çµç®—å±•æœ›</h3>
                    <div style="background: white; padding: 20px; border-radius: 8px; border: 2px solid #fbbf24; white-space: pre-line; color: #78350f; line-height: 1.8;">{{ ai_settlement_prediction.settlement_outlook }}</div>
                </div>

                <div style="background: rgba(255, 255, 255, 0.9); border-radius: 12px; padding: 25px;">
                    <h3 style="color: #92400e; margin-bottom: 15px; font-size: 1.3rem;">âš™ï¸ çµç®—ç­–ç•¥å»ºè­°</h3>
                    <div style="display: grid; gap: 15px;">
                        <div style="background: white; padding: 15px; border-radius: 8px;">
                            <div style="font-weight: 600; color: #92400e; margin-bottom: 8px;">ğŸ• çµç®—å‰æº–å‚™:</div>
                            <p style="color: #78350f; margin: 0;">{{ ai_settlement_prediction.strategy_recommendation.before_settlement }}</p>
                        </div>
                        <div style="background: white; padding: 15px; border-radius: 8px;">
                            <div style="font-weight: 600; color: #92400e; margin-bottom: 8px;">âš¡ çµç®—ç•¶ä¸‹:</div>
                            <p style="color: #78350f; margin: 0;">{{ ai_settlement_prediction.strategy_recommendation.during_settlement }}</p>
                        </div>
                        <div style="background: white; padding: 15px; border-radius: 8px;">
                            <div style="font-weight: 600; color: #92400e; margin-bottom: 8px;">ğŸ“Š å€‰ä½ç®¡ç†:</div>
                            <p style="color: #78350f; margin: 0;">{{ ai_settlement_prediction.strategy_recommendation.position_management }}</p>
                        </div>
                    </div>
                </div>
            </div>
            {% endif %}

            <!-- AI Settlement Review -->
            {% if ai_settlement_review %}
            <div class="section" style="background: linear-gradient(135deg, #ede9fe 0%, #8b5cf6 100%); color: #3b0764;">
                <div class="section-header" style="border-bottom-color: rgba(59, 7, 100, 0.2);">
                    <span class="section-icon">ğŸ“</span>
                    <h2 class="section-title" style="color: #3b0764;">çµç®—æª¢è¨ {{ ai_settlement_review.score }}</h2>
                </div>

                <div style="background: rgba(255, 255, 255, 0.9); border-radius: 12px; padding: 25px; margin-bottom: 25px;">
                    <h3 style="color: #5b21b6; margin-bottom: 15px; font-size: 1.3rem;">ğŸ“Š æº–ç¢ºåº¦åˆ†æ</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px;">
                        <div style="background: white; padding: 15px; border-radius: 8px; border-left: 4px solid #8b5cf6;">
                            <div style="font-size: 0.85rem; color: #6b21a8; margin-bottom: 5px;">é æ¸¬æº–ç¢ºåº¦</div>
                            <div style="font-size: 1.5rem; font-weight: 700; color: #5b21b6;">{{ ai_settlement_review.accuracy.overall_accuracy }}%</div>
                        </div>
                        <div style="background: white; padding: 15px; border-radius: 8px; border-left: 4px solid #8b5cf6;">
                            <div style="font-size: 0.85rem; color: #6b21a8; margin-bottom: 5px;">åƒ¹æ ¼èª¤å·®</div>
                            <div style="font-size: 1.3rem; font-weight: 700; color: #5b21b6;">{{ ai_settlement_review.accuracy.price_error }} ({{ ai_settlement_review.accuracy.price_error_percent }}%)</div>
                        </div>
                        <div style="background: white; padding: 15px; border-radius: 8px; border-left: 4px solid #8b5cf6;">
                            <div style="font-size: 0.85rem; color: #6b21a8; margin-bottom: 5px;">å€é–“é æ¸¬</div>
                            <div style="font-size: 1.3rem; font-weight: 700; color: #5b21b6;">
                                {% if ai_settlement_review.accuracy.in_predicted_range %}âœ… æ­£ç¢º{% else %}âŒ å¤±èª¤{% endif %}
                            </div>
                        </div>
                        <div style="background: white; padding: 15px; border-radius: 8px; border-left: 4px solid #8b5cf6;">
                            <div style="font-size: 0.85rem; color: #6b21a8; margin-bottom: 5px;">æ–¹å‘åˆ¤æ–·</div>
                            <div style="font-size: 1.3rem; font-weight: 700; color: #5b21b6;">
                                {% if ai_settlement_review.accuracy.direction_correct %}âœ… æ­£ç¢º{% else %}âŒ å¤±èª¤{% endif %}
                            </div>
                        </div>
                    </div>
                </div>

                <div style="background: rgba(255, 255, 255, 0.9); border-radius: 12px; padding: 25px; margin-bottom: 25px;">
                    <h3 style="color: #5b21b6; margin-bottom: 15px; font-size: 1.3rem;">ğŸ’­ è‡ªæˆ‘åæ€</h3>
                    <div style="background: white; padding: 20px; border-radius: 8px; border: 2px solid #8b5cf6; white-space: pre-line; color: #3b0764; line-height: 1.8;">{{ ai_settlement_review.self_reflection }}</div>
                </div>

                <div style="background: rgba(255, 255, 255, 0.9); border-radius: 12px; padding: 25px; margin-bottom: 25px;">
                    <h3 style="color: #5b21b6; margin-bottom: 15px; font-size: 1.3rem;">ğŸ“š å­¸åˆ°çš„æ•™è¨“</h3>
                    {% for lesson in ai_settlement_review.lessons_learned %}
                    <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 10px; border-left: 4px solid #8b5cf6;">
                        <p style="color: #3b0764; margin: 0;">{{ lesson }}</p>
                    </div>
                    {% endfor %}
                </div>

                <div style="background: rgba(255, 255, 255, 0.9); border-radius: 12px; padding: 25px;">
                    <h3 style="color: #5b21b6; margin-bottom: 15px; font-size: 1.3rem;">ğŸ¯ æ”¹é€²æ–¹å‘</h3>
                    {% for improvement in ai_settlement_review.improvement_areas %}
                    <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 10px; border-left: 4px solid #8b5cf6;">
                        <p style="color: #3b0764; margin: 0;">{{ improvement }}</p>
                    </div>
                    {% endfor %}
                </div>
            </div>
            {% else %}
            <!-- No Review Yet -->
            <div class="section">
                <div style="background: white; padding: 40px; border-radius: 12px; text-align: center; box-shadow: 0 4px 12px rgba(0,0,0,0.08);">
                    <p style="font-size: 1.5rem; color: var(--text-muted); margin-bottom: 10px;">â³</p>
                    <p style="font-size: 1.2rem; color: var(--text-muted);">çµç®—æ—¥å°šæœªçµæŸï¼Œæª¢è¨å ±å‘Šå°‡åœ¨çµç®—å¾Œç”Ÿæˆ</p>
                </div>
            </div>
            {% endif %}
        </div>
        <!-- End Settlement Review Tab -->

        <!-- Footer -->
        <footer>
            <p>æœ¬å ±å‘ŠåŸºæ–¼æ­·å²æ•¸æ“šèˆ‡æŠ€è¡“åˆ†æï¼Œåƒ…ä¾›åƒè€ƒï¼Œä¸æ§‹æˆæŠ•è³‡å»ºè­°</p>
            <div class="footer-links">
                <a href="https://github.com/ShoppingLiao/taiex-options-analyzer" target="_blank">GitHub å°ˆæ¡ˆ</a>
            </div>
        </footer>
    </div>

    <script>
        function switchTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remove active class from all buttons
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected tab content
            if (tabName === 'technical') {
                document.getElementById('technical-tab').classList.add('active');
                document.querySelectorAll('.tab-button')[0].classList.add('active');
            } else if (tabName === 'ai-analysis') {
                document.getElementById('ai-analysis-tab').classList.add('active');
                document.querySelectorAll('.tab-button')[1].classList.add('active');
            } else if (tabName === 'trader-view') {
                document.getElementById('trader-view-tab').classList.add('active');
                document.querySelectorAll('.tab-button')[2].classList.add('active');
            } else if (tabName === 'settlement-review') {
                document.getElementById('settlement-review-tab').classList.add('active');
                document.querySelectorAll('.tab-button')[3].classList.add('active');
            }
        }
    </script>
</body>
</html>
