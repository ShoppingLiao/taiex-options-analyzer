<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å°æŒ‡é¸æ“‡æ¬Šåˆ†æå ±å‘Š - {{ date }}</title>
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
    <style>
        :root {
            --primary-color: #2563eb;
            --call-color: #ef4444;
            --put-color: #22c55e;
            --warning-color: #f59e0b;
            --bg-color: #f8fafc;
            --card-bg: #ffffff;
            --text-color: #1e293b;
            --text-muted: #64748b;
            --border-color: #e2e8f0;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        /* æ‰‹æ©Ÿç‰ˆæ¸›å°‘ padding */
        @media (max-width: 768px) {
            .container {
                padding: 12px;
            }
        }

        header {
            background: linear-gradient(135deg, var(--primary-color), #1d4ed8);
            color: white;
            padding: 30px 20px;
            margin-bottom: 30px;
            border-radius: 12px;
            position: relative;
        }

        header h1 {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        header .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        /* å›é¦–é æŒ‰éˆ• */
        .home-button {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            padding: 10px 20px;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .home-button:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        /* æ‰‹æ©Ÿç‰ˆèª¿æ•´ */
        @media (max-width: 768px) {
            .home-button {
                position: static;
                display: inline-flex;
                margin-top: 15px;
            }
            
            header {
                text-align: center;
            }
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px;
            margin-bottom: 30px;
        }

        /* é›»è…¦ç‰ˆï¼š4 æ¬„å¸ƒå±€ */
        @media (min-width: 1024px) {
            .grid {
                grid-template-columns: repeat(4, 1fr);
            }
        }

        /* å¹³æ¿ç‰ˆï¼š3 æ¬„å¸ƒå±€ */
        @media (min-width: 768px) and (max-width: 1023px) {
            .grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        /* æ‰‹æ©Ÿç‰ˆï¼š3 æ¬„å¸ƒå±€ */
        @media (max-width: 767px) {
            .grid {
                grid-template-columns: repeat(3, 1fr);
                gap: 8px;
            }
        }

        .card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 16px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            border: 1px solid var(--border-color);
        }

        /* æ‰‹æ©Ÿç‰ˆæ¸›å°‘ card padding */
        @media (max-width: 767px) {
            .card {
                padding: 12px;
            }
        }

        /* RWD Card å®¹å™¨ */
        .card-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 12px;
            margin-bottom: 30px;
        }

        /* é›»è…¦ç‰ˆï¼šå…©æ¬„å¸ƒå±€ */
        @media (min-width: 768px) {
            .card-container {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        /* æ‰‹æ©Ÿç‰ˆï¼šgap æ›´å° */
        @media (max-width: 767px) {
            .card-container {
                max-width: 600px;
                margin: 0 auto 30px auto;
                gap: 8px;
            }
        }

        .card-title {
            font-size: 0.875rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 8px;
        }

        .card-value {
            font-size: 2rem;
            font-weight: 700;
        }

        .card-subtitle {
            font-size: 0.875rem;
            color: var(--text-muted);
            margin-top: 4px;
        }

        .positive {
            color: var(--put-color);
        }

        .negative {
            color: var(--call-color);
        }

        .neutral {
            color: var(--warning-color);
        }

        .chart-container {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 30px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            border: 1px solid var(--border-color);
        }

        /* æ‰‹æ©Ÿç‰ˆæ¸›å°‘ chart-container padding */
        @media (max-width: 767px) {
            .chart-container {
                padding: 12px;
            }
        }

        .chart-title {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--border-color);
        }

        /* æ—¥å…§åƒ¹æ ¼èµ°å‹¢æ¨£å¼ */
        .price-info-wrapper {
            text-align: center;
            padding: 40px 20px;
        }

        .close-price-display {
            font-size: 3rem;
            margin-bottom: 20px;
            font-weight: 600;
        }

        .close-price-label {
            font-size: 1.2rem;
            color: var(--text-muted);
            margin-bottom: 30px;
        }

        .price-grid {
            max-width: 800px;
            margin: 0 auto;
        }

        .price-item {
            padding: 15px;
            border-radius: 8px;
        }

        .price-item-label {
            font-size: 0.875rem;
            color: var(--text-muted);
            margin-bottom: 5px;
        }

        .price-item-value {
            font-size: 1.5rem;
            font-weight: 600;
        }

        /* æ‰‹æ©Ÿç‰ˆèª¿æ•´åƒ¹æ ¼èµ°å‹¢ */
        @media (max-width: 767px) {
            .price-info-wrapper {
                padding: 20px 12px;
            }

            .close-price-display {
                font-size: 2rem;
                margin-bottom: 12px;
            }

            .close-price-label {
                font-size: 1rem;
                margin-bottom: 20px;
            }

            .price-grid {
                max-width: 100%;
            }

            .price-item {
                padding: 10px 8px;
            }

            .price-item-label {
                font-size: 0.75rem;
                margin-bottom: 4px;
            }

            .price-item-value {
                font-size: 1.1rem;
            }
        }

        /* è¡¨æ ¼æ¨£å¼ - è¨­å®šè¡Œé«˜ */
        table tbody tr {
            height: 20px;
        }

        table tbody td {
            padding: 4px 8px !important;
            line-height: 1.2;
        }

        table thead th {
            padding: 8px !important;
        }

        table tfoot td {
            padding: 8px !important;
        }

        .chart {
            width: 100%;
            height: 600px;
        }

        .chart-small {
            height: 400px;
        }

        .section-title {
            font-size: 1.5rem;
            font-weight: 600;
            margin: 30px 0 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--primary-color);
        }

        .key-levels {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        .level-card {
            text-align: center;
            padding: 20px;
            border-radius: 8px;
        }

        .level-card.resistance {
            background-color: #fef2f2;
            border: 2px solid var(--call-color);
        }

        .level-card.support {
            background-color: #f0fdf4;
            border: 2px solid var(--put-color);
        }

        .level-card.max-pain {
            background-color: #fefce8;
            border: 2px solid var(--warning-color);
        }

        .level-value {
            font-size: 1.75rem;
            font-weight: 700;
            margin-top: 8px;
        }

        .level-label {
            font-size: 0.875rem;
            color: var(--text-muted);
        }

        .level-detail {
            font-size: 0.8rem;
            margin-top: 4px;
        }

        /* å¸‚å ´è§£è®€å€å¡Š */
        .analysis-section {
            background: linear-gradient(135deg, #f0f9ff, #e0f2fe);
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 30px;
            border-left: 4px solid var(--primary-color);
        }

        .analysis-title {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 16px;
            color: var(--primary-color);
        }

        .analysis-list {
            list-style: none;
        }

        .analysis-list li {
            padding: 8px 0;
            border-bottom: 1px solid rgba(0,0,0,0.05);
            display: flex;
            align-items: center;
        }

        .analysis-list li:last-child {
            border-bottom: none;
        }

        .analysis-icon {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            margin-right: 12px;
            font-size: 12px;
        }

        .icon-bullish {
            background-color: #dcfce7;
            color: var(--put-color);
        }

        .icon-bearish {
            background-color: #fee2e2;
            color: var(--call-color);
        }

        .icon-neutral {
            background-color: #fef3c7;
            color: var(--warning-color);
        }

        /* çµç®—æƒ…å¢ƒåˆ†æå€å¡Š */
        .settlement-section {
            margin: 30px 0;
            padding: 24px;
        }

        .settlement-meta {
            background: #f1f5f9;
            padding: 16px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .settlement-meta p {
            margin: 8px 0;
        }

        .scenarios-container {
            display: flex;
            gap: 20px;
            overflow-x: auto;
            padding-bottom: 10px;
            scroll-behavior: smooth;
            -webkit-overflow-scrolling: touch;
        }

        /* æ‰‹æ©Ÿç‰ˆæ»¾å‹•æ¢æ¨£å¼ */
        .scenarios-container::-webkit-scrollbar {
            height: 8px;
        }

        .scenarios-container::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }

        .scenarios-container::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 4px;
        }

        .scenarios-container::-webkit-scrollbar-thumb:hover {
            background: #555;
        }

        .scenario-card {
            background: linear-gradient(135deg, #fafafa, #ffffff);
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            padding: 20px;
            transition: all 0.3s ease;
            min-width: 350px;
            max-width: 400px;
            flex-shrink: 0;
        }

        .scenario-card:hover {
            border-color: var(--primary-color);
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.1);
        }

        .scenario-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 2px solid #e5e7eb;
        }

        .scenario-name {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--text-color);
        }

        .scenario-probability {
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 0.875rem;
            font-weight: 600;
        }

        .probability-é«˜ {
            background: #fee2e2;
            color: #dc2626;
        }

        .probability-ä¸­ç­‰ {
            background: #fef3c7;
            color: #d97706;
        }

        .probability-ä½ {
            background: #dbeafe;
            color: #2563eb;
        }

        .scenario-content {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .scenario-item {
            padding: 12px 0;
        }

        .scenario-item strong {
            color: var(--primary-color);
            display: block;
            margin-bottom: 8px;
        }

        .scenario-range {
            background: linear-gradient(135deg, #dbeafe, #bfdbfe);
            padding: 8px 16px;
            border-radius: 6px;
            font-weight: 600;
            font-size: 1.1rem;
            color: #1e40af;
            display: inline-block;
        }

        .scenario-conditions {
            list-style: none;
            padding-left: 0;
        }

        .scenario-conditions li {
            padding: 6px 12px;
            margin: 4px 0;
            background: #f8fafc;
            border-left: 3px solid var(--primary-color);
            border-radius: 4px;
        }

        .scenario-description, .scenario-impact {
            background: #f9fafb;
            padding: 12px 16px;
            border-radius: 6px;
            line-height: 1.7;
        }

        .scenario-impact {
            background: #fef9f3;
            border-left: 3px solid var(--warning-color);
        }

        .scenario-levels {
            background: #ecfdf5;
            padding: 8px 16px;
            border-radius: 6px;
            font-weight: 600;
            color: #059669;
            display: inline-block;
        }

        /* Tab å°èˆªæ¨£å¼ */
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            border-bottom: 2px solid var(--border-color);
        }

        .tab-button {
            padding: 12px 24px;
            background: none;
            border: none;
            border-bottom: 3px solid transparent;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            color: var(--text-muted);
            transition: all 0.3s ease;
        }

        .tab-button:hover {
            color: var(--primary-color);
        }

        .tab-button.active {
            color: var(--primary-color);
            border-bottom-color: var(--primary-color);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* AI åˆ†ææ¨£å¼ */
        .ai-section {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 30px;
        }

        .ai-scenario-card {
            background: white;
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            border-left: 4px solid var(--primary-color);
        }

        .ai-scenario-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .ai-scenario-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--text-color);
        }

        .ai-probability {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
            padding: 6px 16px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .ai-field {
            margin: 16px 0;
            padding: 12px;
            background: #f9fafb;
            border-radius: 8px;
        }

        .ai-field-label {
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 8px;
            display: block;
        }

        .ai-field-content {
            line-height: 1.7;
            color: var(--text-color);
        }

        .ai-observation-list {
            list-style: none;
            padding: 0;
        }

        .ai-observation-list li {
            padding: 12px;
            margin: 8px 0;
            background: white;
            border-left: 3px solid #22c55e;
            border-radius: 4px;
        }

        .ai-key-level {
            display: inline-block;
            background: #dbeafe;
            padding: 6px 12px;
            margin: 4px;
            border-radius: 6px;
            font-weight: 600;
            color: #1e40af;
        }

        .ai-warning {
            background: #fef3c7;
            border-left: 4px solid #f59e0b;
            padding: 16px;
            border-radius: 8px;
            margin: 12px 0;
        }

        .ai-recommendation {
            background: #dcfce7;
            border-left: 4px solid #22c55e;
            padding: 16px;
            border-radius: 8px;
            margin: 12px 0;
        }

        /* åœ–ä¾‹ */
        .chart-legend {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-bottom: 10px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 4px;
        }

        .legend-call {
            background-color: var(--call-color);
        }

        .legend-put {
            background-color: var(--put-color);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        th, td {
            padding: 12px;
            text-align: right;
            border-bottom: 1px solid var(--border-color);
        }

        th {
            background-color: var(--bg-color);
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.75rem;
            letter-spacing: 0.05em;
            color: var(--text-muted);
        }

        td:first-child, th:first-child {
            text-align: left;
        }

        tr:hover {
            background-color: var(--bg-color);
        }

        footer {
            background: white;
            border-radius: 16px;
            padding: 20px;
            text-align: center;
            color: var(--text-muted);
            font-size: 0.9rem;
            margin-top: 30px;
        }

        .footer-links {
            margin-top: 10px;
        }

        .footer-links a {
            color: var(--primary-color);
            text-decoration: none;
            margin: 0 10px;
            transition: all 0.3s;
        }

        .footer-links a:hover {
            text-decoration: underline;
        }

        @media (max-width: 768px) {
            /* å…¨åŸŸç·Šæ¹Š */
            body {
                font-size: 0.85rem;
                line-height: 1.4;
            }

            .container {
                padding: 6px;
            }

            /* Header ç¸®æ¸›åˆ° 40% */
            header {
                padding: 10px 12px;
                margin-bottom: 8px;
                border-radius: 6px;
            }

            header h1 {
                font-size: 1.1rem;
                margin-bottom: 3px;
            }

            header .subtitle {
                font-size: 0.75rem;
            }

            .home-button {
                position: static;
                display: inline-flex;
                margin-top: 6px;
                padding: 5px 10px;
                font-size: 0.75rem;
                gap: 4px;
            }

            /* å¡ç‰‡ç·Šæ¹ŠåŒ– */
            .card-value {
                font-size: 1.1rem !important;
            }

            .card-label {
                font-size: 0.7rem !important;
            }

            .card {
                padding: 8px 10px !important;
            }

            /* Grid å„ªåŒ– */
            .grid {
                gap: 6px;
                margin-bottom: 12px;
                grid-template-columns: repeat(2, 1fr) !important;
            }

            /* é—œéµåƒ¹ä½ */
            .key-levels {
                grid-template-columns: 1fr !important;
                gap: 6px !important;
            }

            /* åœ–è¡¨é«˜åº¦ */
            .chart {
                height: 300px !important;
            }

            /* Section */
            .section {
                margin-bottom: 8px !important;
                padding: 10px 8px !important;
                border-radius: 6px !important;
            }

            .section h2 {
                font-size: 1rem !important;
                margin-bottom: 8px !important;
            }

            /* Tab æŒ‰éˆ• - æ©«å‘æ»¾å‹• */
            .tabs {
                overflow-x: auto !important;
                overflow-y: hidden !important;
                -webkit-overflow-scrolling: touch !important;
                white-space: nowrap !important;
                gap: 4px !important;
                padding: 4px !important;
                margin-bottom: 8px !important;
            }

            .tabs::-webkit-scrollbar {
                height: 3px !important;
            }

            .tab-button {
                display: inline-block !important;
                padding: 6px 10px !important;
                font-size: 0.8rem !important;
                border-radius: 6px 6px 0 0 !important;
                min-width: auto !important;
            }

            /* Footer */
            footer {
                margin-top: 12px !important;
                padding: 10px !important;
                font-size: 0.7rem !important;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <a href="index.html" class="home-button">
                <span>ğŸ </span>
                <span>å›é¦–é </span>
            </a>
            <h1>å°æŒ‡é¸æ“‡æ¬Šåˆ†æå ±å‘Š</h1>
            <div class="subtitle">
                äº¤æ˜“æ—¥æœŸ: {{ date_with_weekday }} | å¥‘ç´„æœˆä»½: {{ contract_month }} | çµç®—æ—¥: 2026/01/21 (äºŒ)
            </div>
        </header>

        <!-- Tab å°èˆª -->
        <div class="tabs">
            <button class="tab-button active" onclick="switchTab(event, 'basic-data')">
                ğŸ“ˆ åŸºæœ¬è³‡æ–™
            </button>
            <button class="tab-button" onclick="switchTab(event, 'standard-analysis')">
                ğŸ“Š æ¨™æº–åˆ†æ
            </button>
            <button class="tab-button" onclick="switchTab(event, 'ai-analysis')">
                ï¿½â€ğŸ’¼ AI äº¤æ˜“å“¡è¦–è§’
            </button>
        </div>

        <!-- åŸºæœ¬è³‡æ–™ Tab -->
        <div id="basic-data" class="tab-content active">
            <h2 class="section-title">å°æŒ‡æœŸè²¨åŸºæœ¬è³‡æ–™</h2>
            
            <div class="grid">
                <div class="card">
                    <div class="card-title">é–‹ç›¤åƒ¹</div>
                    <div class="card-value">{{ "{:,.0f}".format(tx_data.open) }}</div>
                    <div class="card-subtitle">Opening Price</div>
                </div>
                <div class="card">
                    <div class="card-title">æœ€é«˜åƒ¹</div>
                    <div class="card-value" style="color: #ef4444;">{{ "{:,.0f}".format(tx_data.high) }}</div>
                    <div class="card-subtitle">Highest Price</div>
                </div>
                <div class="card">
                    <div class="card-title">æœ€ä½åƒ¹</div>
                    <div class="card-value" style="color: #22c55e;">{{ "{:,.0f}".format(tx_data.low) }}</div>
                    <div class="card-subtitle">Lowest Price</div>
                </div>
                <div class="card">
                    <div class="card-title">æ”¶ç›¤åƒ¹</div>
                    <div class="card-value {% if tx_data.close > tx_data.open %}negative{% elif tx_data.close < tx_data.open %}positive{% endif %}">{{ "{:,.0f}".format(tx_data.close) }}</div>
                    <div class="card-subtitle">Closing Price</div>
                </div>
                <div class="card">
                    <div class="card-title">æˆäº¤é‡</div>
                    <div class="card-value">{{ "{:,}".format(tx_data.volume) }}</div>
                    <div class="card-subtitle">å£ (Contracts)</div>
                </div>
                <div class="card">
                    <div class="card-title">çµç®—åƒ¹</div>
                    <div class="card-value">{{ "{:,.0f}".format(tx_data.settlement) }}</div>
                    <div class="card-subtitle">Settlement Price</div>
                </div>
            </div>

            <div class="chart-container">
                <h3 class="chart-title">æ—¥å…§åƒ¹æ ¼èµ°å‹¢</h3>
                <div class="card">
                    <div class="price-info-wrapper">
                        <div class="close-price-display">
                            {{ "{:,.0f}".format(tx_data.close) }}
                        </div>
                        <div class="close-price-label">
                            æ”¶ç›¤åƒ¹æ ¼
                        </div>
                        <div class="grid price-grid">
                            <div class="price-item" style="background: #f1f5f9;">
                                <div class="price-item-label">é–‹ç›¤</div>
                                <div class="price-item-value">{{ "{:,.0f}".format(tx_data.open) }}</div>
                            </div>
                            <div class="price-item" style="background: #fee2e2;">
                                <div class="price-item-label">æœ€é«˜</div>
                                <div class="price-item-value" style="color: #dc2626;">{{ "{:,.0f}".format(tx_data.high) }}</div>
                            </div>
                            <div class="price-item" style="background: #dcfce7;">
                                <div class="price-item-label">æœ€ä½</div>
                                <div class="price-item-value" style="color: #16a34a;">{{ "{:,.0f}".format(tx_data.low) }}</div>
                            </div>
                            <div class="price-item" style="background: #f1f5f9;">
                                <div class="price-item-label">éœ‡ç›ªå¹…åº¦</div>
                                <div class="price-item-value">{{ "{:,.0f}".format(tx_data.high - tx_data.low) }}</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="analysis-section">
                <h3 class="chart-title">å¸‚å ´æ•¸æ“šèªªæ˜</h3>
                <div class="card">
                    <ul style="list-style: none; padding: 0;">
                        <li style="padding: 15px; border-bottom: 1px solid var(--border-color);">
                            <div style="font-weight: 600; margin-bottom: 5px;">ğŸ“Š æ”¶ç›¤åƒ¹ {{ "{:,.0f}".format(tx_data.close) }}</div>
                            <div style="color: var(--text-muted); font-size: 0.875rem;">ç•¶æ—¥æœ€å¾Œæˆäº¤åƒ¹æ ¼ï¼Œä½œç‚ºé¸æ“‡æ¬Šçµç®—åˆ†æçš„é‡è¦åƒè€ƒ</div>
                        </li>
                        <li style="padding: 15px; border-bottom: 1px solid var(--border-color);">
                            <div style="font-weight: 600; margin-bottom: 5px;">ğŸ“ˆ æ—¥å…§éœ‡ç›ª {{ "{:,.0f}".format(tx_data.high - tx_data.low) }} é»</div>
                            <div style="color: var(--text-muted); font-size: 0.875rem;">æœ€é«˜åƒ¹ {{ "{:,.0f}".format(tx_data.high) }} - æœ€ä½åƒ¹ {{ "{:,.0f}".format(tx_data.low) }}</div>
                        </li>
                        <li style="padding: 15px;">
                            <div style="font-weight: 600; margin-bottom: 5px;">ğŸ“‰ æˆäº¤é‡ {{ "{:,}".format(tx_data.volume) }} å£</div>
                            <div style="color: var(--text-muted); font-size: 0.875rem;">ç•¶æ—¥å°æŒ‡æœŸè²¨ç¸½æˆäº¤é‡ï¼Œåæ˜ å¸‚å ´åƒèˆ‡åº¦</div>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- æ¨™æº–åˆ†æ Tab -->
        <div id="standard-analysis" class="tab-content"
        <!-- é—œéµæŒ‡æ¨™å¡ç‰‡ -->
        <div class="grid">
            <div class="card">
                <div class="card-title">Max Pain æœ€å¤§ç—›é»</div>
                <div class="card-value">{{ "{:,}".format(max_pain) }}</div>
                <div class="card-subtitle">é¸æ“‡æ¬Šçµç®—æ”¶æ–‚é»</div>
            </div>
            <div class="card">
                <div class="card-title">P/C Ratio (æœªå¹³å€‰)</div>
                <div class="card-value {{ 'negative' if pc_ratio_oi > 1.1 else ('positive' if pc_ratio_oi < 0.9 else 'neutral') }}">
                    {{ "%.4f"|format(pc_ratio_oi) }}
                </div>
                <div class="card-subtitle">{{ market_sentiment }}</div>
            </div>
            <div class="card">
                <div class="card-title">è²·æ¬Šç¸½æœªå¹³å€‰</div>
                <div class="card-value" style="color: var(--call-color);">{{ "{:,}".format(total_call_oi) }}</div>
                <div class="card-subtitle">
                    è®ŠåŒ–: <span class="{{ 'positive' if call_oi_change > 0 else 'negative' }}">{{ "{:+,}".format(call_oi_change) }}</span>
                </div>
            </div>
            <div class="card">
                <div class="card-title">è³£æ¬Šç¸½æœªå¹³å€‰</div>
                <div class="card-value" style="color: var(--put-color);">{{ "{:,}".format(total_put_oi) }}</div>
                <div class="card-subtitle">
                    è®ŠåŒ–: <span class="{{ 'positive' if put_oi_change > 0 else 'negative' }}">{{ "{:+,}".format(put_oi_change) }}</span>
                </div>
            </div>
        </div>

        <!-- é—œéµåƒ¹ä½ -->
        <div class="key-levels">
            <div class="level-card resistance">
                <div class="level-label">å£“åŠ›å€ (è²·æ¬Š OI æœ€å¤§)</div>
                <div class="level-value negative">{{ "{:,}".format(max_call_oi_strike) }}</div>
                <div class="level-detail">{{ "{:,}".format(max_call_oi) }} å£</div>
            </div>
            <div class="level-card max-pain">
                <div class="level-label">Max Pain</div>
                <div class="level-value">{{ "{:,}".format(max_pain) }}</div>
                <div class="level-detail">çµç®—æ”¶æ–‚é»</div>
            </div>
            <div class="level-card support">
                <div class="level-label">æ”¯æ’å€ (è³£æ¬Š OI æœ€å¤§)</div>
                <div class="level-value positive">{{ "{:,}".format(max_put_oi_strike) }}</div>
                <div class="level-detail">{{ "{:,}".format(max_put_oi) }} å£</div>
            </div>
        </div>

        <!-- å¸‚å ´è§£è®€ -->
        <div class="analysis-section">
            <h3 class="analysis-title">ğŸ“Š å¸‚å ´è§£è®€</h3>
            <ul class="analysis-list">
                {% for item in analysis_items %}
                <li>
                    <span class="analysis-icon {{ item.icon_class }}">{{ item.icon }}</span>
                    {{ item.text }}
                </li>
                {% endfor %}
            </ul>
        </div>

        <!-- çµç®—æƒ…å¢ƒåˆ†æ -->
        {% if settlement_scenarios %}
        <div class="settlement-section card">
            <h3 class="analysis-title">ğŸ¯ {{ contract_month }} çµç®—æƒ…å¢ƒåˆ†æ</h3>
            
            <div class="settlement-meta">
                <p><strong>èŠå®¶ä½ç½®åˆ¤æ–·ï¼š</strong> {{ dealer_position }}</p>
                <p><strong>å¸‚å ´åå‘ï¼š</strong> {{ market_bias }}</p>
            </div>

            <div class="scenarios-container">
                {% for scenario in settlement_scenarios %}
                <div class="scenario-card">
                    <div class="scenario-header">
                        <h4 class="scenario-name">{{ scenario.name }}</h4>
                        <span class="scenario-probability probability-{{ scenario.probability|lower }}">
                            æ©Ÿç‡ï¼š{{ scenario.probability }}
                        </span>
                    </div>
                    
                    <div class="scenario-content">
                        <div class="scenario-item">
                            <strong>çµç®—å€é–“ï¼š</strong>
                            <span class="scenario-range">{{ scenario.settlement_range }} é»</span>
                        </div>
                        
                        <div class="scenario-item">
                            <strong>è§¸ç™¼æ¢ä»¶ï¼š</strong>
                            <ul class="scenario-conditions">
                                {% for condition in scenario.conditions %}
                                <li>{{ condition }}</li>
                                {% endfor %}
                            </ul>
                        </div>
                        
                        <div class="scenario-item">
                            <strong>æƒ…å¢ƒæè¿°ï¼š</strong>
                            <p class="scenario-description">{{ scenario.description }}</p>
                        </div>
                        
                        <div class="scenario-item">
                            <strong>çµç®—å½±éŸ¿ï¼š</strong>
                            <p class="scenario-impact">{{ scenario.impact }}</p>
                        </div>
                        
                        <div class="scenario-item">
                            <strong>é—œéµåƒ¹ä½ï¼š</strong>
                            <span class="scenario-levels">{{ scenario.key_levels|join(', ') }} é»</span>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
        {% endif %}

        <!-- RWD Card å®¹å™¨ï¼šåŒ…å«å…©å€‹è¡¨æ ¼ -->
        <div class="card-container">
            <!-- OI åˆ†å¸ƒè¡¨æ ¼ (è¿‘æœˆé¸æ“‡æ¬Š OI è®ŠåŒ–) -->
            <div class="chart-container card">
                <h3 class="chart-title" style="text-align: center; background: linear-gradient(135deg, #dc2626, #16a34a); color: white; padding: 15px; border-radius: 8px 8px 0 0; margin: -24px -24px 20px -24px;">
                    è¿‘æœˆé¸æ“‡æ¬Š OI è®ŠåŒ–
                </h3>
                <div style="text-align: center; margin-bottom: 15px; font-size: 0.95rem; color: var(--text-muted); font-weight: 600;">
                    çµç®—æ—¥ï¼š2026/01/21
                </div>
                
                <!-- OI åˆ†å¸ƒè¡¨æ ¼ -->
            <div style="overflow-x: auto;">
                <table style="width: 100%; border-collapse: collapse; font-size: 0.9rem;">
                    <thead>
                        <tr style="background: linear-gradient(to right, #ef4444, #3b82f6, #22c55e);">
                            <th colspan="2" style="background: #ef4444; color: white; padding: 12px; text-align: center; font-size: 1.1rem; border: 1px solid #dc2626;">Call</th>
                            <th style="background: #3b82f6; color: white; padding: 12px; text-align: center; font-size: 1.1rem; border: 1px solid #2563eb;">{{ contract_month }}</th>
                            <th colspan="2" style="background: #22c55e; color: white; padding: 12px; text-align: center; font-size: 1.1rem; border: 1px solid #16a34a;">Put</th>
                        </tr>
                        <tr style="background: #f3f4f6;">
                            <th style="background: #fecaca; color: #dc2626; padding: 10px; text-align: center; border: 1px solid #fca5a5; font-weight: 600;">OIå¢æ¸›</th>
                            <th style="background: #fecaca; color: #dc2626; padding: 10px; text-align: center; border: 1px solid #fca5a5; font-weight: 600;">OI</th>
                            <th style="background: #1f2937; color: white; padding: 10px; text-align: center; border: 1px solid #374151; font-weight: 600;">å±¥ç´„åƒ¹</th>
                            <th style="background: #bbf7d0; color: #16a34a; padding: 10px; text-align: center; border: 1px solid #86efac; font-weight: 600;">OI</th>
                            <th style="background: #bbf7d0; color: #16a34a; padding: 10px; text-align: center; border: 1px solid #86efac; font-weight: 600;">OIå¢æ¸›</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for row in data_rows %}
                        {% set strike = row.strike %}
                        {% set call_oi = row.call_oi %}
                        {% set call_change = row.call_oi_change %}
                        {% set put_oi = row.put_oi %}
                        {% set put_change = row.put_oi_change %}
                        {% set total_oi = call_oi + put_oi %}
                        
                        {% if total_oi > 0 %}
                        <tr style="{% if strike == max_put_oi_strike %}background: #dcfce7;{% elif strike == max_call_oi_strike %}background: #fee2e2;{% elif strike == tx_data.close %}background: #fef3c7;{% elif strike == max_pain %}background: #fed7aa;{% else %}background: white;{% endif %}">
                            <!-- Call OI å¢æ¸› -->
                            <td style="padding: 8px; text-align: right; border: 1px solid #e5e7eb; {% if call_change < 0 %}color: #dc2626; font-weight: 600;{% elif call_change > 0 %}color: #ef4444;{% endif %}">
                                {% if call_change != 0 %}{{ call_change }}{% endif %}
                            </td>
                            
                            <!-- Call OI -->
                            <td style="padding: 8px; text-align: right; border: 1px solid #e5e7eb; position: relative;">
                                <div style="position: relative; z-index: 1;">{{ "{:,}".format(call_oi) if call_oi > 0 else "" }}</div>
                                {% if call_oi > 0 %}
                                <div style="position: absolute; right: 0; top: 0; height: 100%; background: rgba(239, 68, 68, {{ (call_oi / max_call_oi * 0.7) }}); width: {{ (call_oi / max_call_oi * 100) }}%; z-index: 0;"></div>
                                {% endif %}
                            </td>
                            
                            <!-- å±¥ç´„åƒ¹ -->
                            <td style="padding: 8px; text-align: center; border: 1px solid #374151; background: #1f2937; color: white; font-weight: 700; position: relative;">
                                {{ "{:,}".format(strike) }}
                                {% if strike == max_put_oi_strike %}
                                <span style="position: absolute; right: 5px; top: 50%; transform: translateY(-50%); color: #22c55e; font-size: 1.2rem;">â–º</span>
                                {% endif %}
                                {% if strike == max_call_oi_strike %}
                                <span style="position: absolute; left: 5px; top: 50%; transform: translateY(-50%); color: #ef4444; font-size: 1.2rem;">â—„</span>
                                {% endif %}
                            </td>
                            
                            <!-- Put OI -->
                            <td style="padding: 8px; text-align: left; border: 1px solid #e5e7eb; position: relative;">
                                <div style="position: relative; z-index: 1;">{{ "{:,}".format(put_oi) if put_oi > 0 else "" }}</div>
                                {% if put_oi > 0 %}
                                <div style="position: absolute; left: 0; top: 0; height: 100%; background: rgba(34, 197, 94, {{ (put_oi / max_put_oi * 0.7) }}); width: {{ (put_oi / max_put_oi * 100) }}%; z-index: 0;"></div>
                                {% endif %}
                            </td>
                            
                            <!-- Put OI å¢æ¸› -->
                            <td style="padding: 8px; text-align: left; border: 1px solid #e5e7eb; {% if put_change < 0 %}color: #16a34a; font-weight: 600;{% elif put_change > 0 %}color: #22c55e;{% endif %}">
                                {% if put_change != 0 %}{{ put_change }}{% endif %}
                            </td>
                        </tr>
                        {% endif %}
                        {% endfor %}
                    </tbody>
                    <tfoot>
                        <tr style="background: #1f2937; color: white; font-weight: 700; font-size: 1rem;">
                            <td style="padding: 12px; text-align: center; border: 1px solid #374151;" colspan="2">
                                Call OI: {{ "{:,}".format(total_call_oi) }}
                            </td>
                            <td style="padding: 12px; text-align: center; border: 1px solid #374151; background: #111827;">
                                åˆè¨ˆ
                            </td>
                            <td style="padding: 12px; text-align: center; border: 1px solid #374151;" colspan="2">
                                Put OI: {{ "{:,}".format(total_put_oi) }}
                            </td>
                        </tr>
                        <tr style="background: #f3f4f6; font-size: 1.05rem; font-weight: 600;">
                            <td colspan="5" style="padding: 15px; text-align: center; border: 1px solid #e5e7eb;">
                                P/C Ratio: {{ "%.4f"|format(pc_ratio_oi) }}
                                <span style="color: {% if pc_ratio_oi > 1.1 %}#16a34a{% elif pc_ratio_oi < 0.9 %}#dc2626{% else %}#64748b{% endif %}; margin-left: 10px;">
                                    ({{ "%+.4f"|format(pc_ratio_oi - 1) }})
                                </span>
                            </td>
                        </tr>
                    </tfoot>
                </table>
            </div>
            
            <!-- åœ–ä¾‹èªªæ˜ -->
            <div style="margin-top: 20px; padding: 15px; background: #f8fafc; border-radius: 8px; font-size: 0.85rem;">
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px;">
                    <div><span style="display: inline-block; width: 15px; height: 15px; background: #fef3c7; border: 1px solid #fde047; margin-right: 5px;"></span>æ”¶ç›¤åƒ¹: {{ "{:,}".format(tx_data.close) }}</div>
                    <div><span style="display: inline-block; width: 15px; height: 15px; background: #fed7aa; border: 1px solid #fdba74; margin-right: 5px;"></span>Max Pain: {{ "{:,}".format(max_pain) }}</div>
                    <div><span style="display: inline-block; width: 15px; height: 15px; background: #fee2e2; border: 1px solid #fca5a5; margin-right: 5px;"></span>æœ€å¤§ Call OI: {{ "{:,}".format(max_call_oi_strike) }}</div>
                    <div><span style="display: inline-block; width: 15px; height: 15px; background: #dcfce7; border: 1px solid #86efac; margin-right: 5px;"></span>æœ€å¤§ Put OI: {{ "{:,}".format(max_put_oi_strike) }}</div>
                </div>
            </div>
            </div>

            <!-- OI è®ŠåŒ–è¡¨æ ¼ -->
            <div class="chart-container card">
                <h3 class="chart-title" style="text-align: center; background: linear-gradient(135deg, #dc2626, #16a34a); color: white; padding: 15px; border-radius: 8px 8px 0 0; margin: -24px -24px 20px -24px;">
                    é¸æ“‡æ¬Š OI è®ŠåŒ–
                </h3>
            
            <!-- OI è®ŠåŒ–è¡¨æ ¼ -->
            <div style="overflow-x: auto;">
                <table style="width: 100%; border-collapse: collapse; font-size: 0.9rem;">
                    <thead>
                        <tr style="background: linear-gradient(to right, #ef4444, #3b82f6, #22c55e);">
                            <th colspan="2" style="background: #ef4444; color: white; padding: 12px; text-align: center; font-size: 1.1rem; border: 1px solid #dc2626;">Call è®ŠåŒ–</th>
                            <th style="background: #3b82f6; color: white; padding: 12px; text-align: center; font-size: 1.1rem; border: 1px solid #2563eb;">å±¥ç´„åƒ¹</th>
                            <th colspan="2" style="background: #22c55e; color: white; padding: 12px; text-align: center; font-size: 1.1rem; border: 1px solid #16a34a;">Put è®ŠåŒ–</th>
                        </tr>
                        <tr style="background: #f3f4f6;">
                            <th style="background: #fecaca; color: #dc2626; padding: 10px; text-align: center; border: 1px solid #fca5a5; font-weight: 600;">å¢åŠ </th>
                            <th style="background: #fecaca; color: #dc2626; padding: 10px; text-align: center; border: 1px solid #fca5a5; font-weight: 600;">æ¸›å°‘</th>
                            <th style="background: #1f2937; color: white; padding: 10px; text-align: center; border: 1px solid #374151; font-weight: 600;">Strike</th>
                            <th style="background: #bbf7d0; color: #16a34a; padding: 10px; text-align: center; border: 1px solid #86efac; font-weight: 600;">å¢åŠ </th>
                            <th style="background: #bbf7d0; color: #16a34a; padding: 10px; text-align: center; border: 1px solid #86efac; font-weight: 600;">æ¸›å°‘</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for row in data_rows %}
                        {% set strike = row.strike %}
                        {% set call_change = row.call_oi_change %}
                        {% set put_change = row.put_oi_change %}
                        {% set total_change = call_change|abs + put_change|abs %}
                        
                        {% if total_change > 0 %}
                        <tr style="{% if strike == tx_data.close %}background: #fef3c7;{% elif strike == max_pain %}background: #fed7aa;{% else %}background: white;{% endif %}">
                            <!-- Call å¢åŠ  -->
                            <td style="padding: 8px; text-align: right; border: 1px solid #e5e7eb; position: relative;">
                                {% if call_change > 0 %}
                                <div style="position: relative; z-index: 1; color: #ef4444; font-weight: 600;">+{{ "{:,}".format(call_change) }}</div>
                                <div style="position: absolute; right: 0; top: 0; height: 100%; background: rgba(239, 68, 68, 0.2); width: {{ (call_change / 200 * 100) if call_change < 200 else 100 }}%; z-index: 0;"></div>
                                {% endif %}
                            </td>
                            
                            <!-- Call æ¸›å°‘ -->
                            <td style="padding: 8px; text-align: right; border: 1px solid #e5e7eb; position: relative;">
                                {% if call_change < 0 %}
                                <div style="position: relative; z-index: 1; color: #dc2626; font-weight: 700;">{{ "{:,}".format(call_change) }}</div>
                                <div style="position: absolute; right: 0; top: 0; height: 100%; background: rgba(220, 38, 38, 0.3); width: {{ ((call_change|abs) / 200 * 100) if (call_change|abs) < 200 else 100 }}%; z-index: 0;"></div>
                                {% endif %}
                            </td>
                            
                            <!-- å±¥ç´„åƒ¹ -->
                            <td style="padding: 8px; text-align: center; border: 1px solid #374151; background: #1f2937; color: white; font-weight: 700;">
                                {{ "{:,}".format(strike) }}
                            </td>
                            
                            <!-- Put å¢åŠ  -->
                            <td style="padding: 8px; text-align: left; border: 1px solid #e5e7eb; position: relative;">
                                {% if put_change > 0 %}
                                <div style="position: relative; z-index: 1; color: #22c55e; font-weight: 600;">+{{ "{:,}".format(put_change) }}</div>
                                <div style="position: absolute; left: 0; top: 0; height: 100%; background: rgba(34, 197, 94, 0.2); width: {{ (put_change / 200 * 100) if put_change < 200 else 100 }}%; z-index: 0;"></div>
                                {% endif %}
                            </td>
                            
                            <!-- Put æ¸›å°‘ -->
                            <td style="padding: 8px; text-align: left; border: 1px solid #e5e7eb; position: relative;">
                                {% if put_change < 0 %}
                                <div style="position: relative; z-index: 1; color: #16a34a; font-weight: 700;">{{ "{:,}".format(put_change) }}</div>
                                <div style="position: absolute; left: 0; top: 0; height: 100%; background: rgba(22, 163, 74, 0.3); width: {{ ((put_change|abs) / 200 * 100) if (put_change|abs) < 200 else 100 }}%; z-index: 0;"></div>
                                {% endif %}
                            </td>
                        </tr>
                        {% endif %}
                        {% endfor %}
                    </tbody>
                    <tfoot>
                        <tr style="background: #1f2937; color: white; font-weight: 700; font-size: 1rem;">
                            <td style="padding: 12px; text-align: center; border: 1px solid #374151;" colspan="2">
                                Call ç¸½è®ŠåŒ–: {% if call_oi_change > 0 %}+{% endif %}{{ "{:,}".format(call_oi_change) }}
                            </td>
                            <td style="padding: 12px; text-align: center; border: 1px solid #374151; background: #111827;">
                                åˆè¨ˆ
                            </td>
                            <td style="padding: 12px; text-align: center; border: 1px solid #374151;" colspan="2">
                                Put ç¸½è®ŠåŒ–: {% if put_oi_change > 0 %}+{% endif %}{{ "{:,}".format(put_oi_change) }}
                            </td>
                        </tr>
                    </tfoot>
                </table>
            </div>
            
            <!-- åœ–ä¾‹èªªæ˜ -->
            <div style="margin-top: 20px; padding: 15px; background: #f8fafc; border-radius: 8px; font-size: 0.85rem;">
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px;">
                    <div><span style="display: inline-block; width: 15px; height: 15px; background: #fca5a5; border: 1px solid #f87171; margin-right: 5px;"></span>Call å¢åŠ ï¼ˆæ·¡ç´…ï¼‰</div>
                    <div><span style="display: inline-block; width: 15px; height: 15px; background: #dc2626; border: 1px solid #b91c1c; margin-right: 5px;"></span>Call æ¸›å°‘ï¼ˆæ·±ç´…ï¼‰</div>
                    <div><span style="display: inline-block; width: 15px; height: 15px; background: #86efac; border: 1px solid #4ade80; margin-right: 5px;"></span>Put å¢åŠ ï¼ˆæ·¡ç¶ ï¼‰</div>
                    <div><span style="display: inline-block; width: 15px; height: 15px; background: #16a34a; border: 1px solid #15803d; margin-right: 5px;"></span>Put æ¸›å°‘ï¼ˆæ·±ç¶ ï¼‰</div>
                </div>
            </div>
            </div>
        </div>
        <!-- çµæŸ card-container -->

        <!-- è©³ç´°è³‡æ–™è¡¨ -->
        <h2 class="section-title">è©³ç´°è³‡æ–™</h2>
        <div class="card">
            <table>
                <thead>
                    <tr>
                        <th>å±¥ç´„åƒ¹</th>
                        <th style="color: var(--call-color);">è²·æ¬Šæœªå¹³å€‰</th>
                        <th style="color: var(--call-color);">è²·æ¬ŠOIè®ŠåŒ–</th>
                        <th style="color: var(--put-color);">è³£æ¬Šæœªå¹³å€‰</th>
                        <th style="color: var(--put-color);">è³£æ¬ŠOIè®ŠåŒ–</th>
                        <th>ç¸½OI</th>
                    </tr>
                </thead>
                <tbody>
                    {% for row in data_rows %}
                    <tr>
                        <td><strong>{{ "{:,}".format(row.strike) }}</strong></td>
                        <td style="color: var(--call-color);">{{ "{:,}".format(row.call_oi) }}</td>
                        <td class="{{ 'positive' if row.call_oi_change > 0 else ('negative' if row.call_oi_change < 0 else '') }}">
                            {{ "{:+,}".format(row.call_oi_change) }}
                        </td>
                        <td style="color: var(--put-color);">{{ "{:,}".format(row.put_oi) }}</td>
                        <td class="{{ 'positive' if row.put_oi_change > 0 else ('negative' if row.put_oi_change < 0 else '') }}">
                            {{ "{:+,}".format(row.put_oi_change) }}
                        </td>
                        <td>{{ "{:,}".format(row.call_oi + row.put_oi) }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <footer>
            <p>å ±å‘Šç”¢ç”Ÿæ™‚é–“: {{ generated_at }} | TAIEX Options Analyzer</p>
            <div class="footer-links">
                <a href="https://github.com/ShoppingLiao/taiex-options-analyzer" target="_blank">GitHub å°ˆæ¡ˆ</a>
            </div>
        </footer>
        </div>
        <!-- çµæŸæ¨™æº–åˆ†æ Tab -->

        <!-- AI äº¤æ˜“å“¡è¦–è§’ Tab -->
        <div id="ai-analysis" class="tab-content">
            {% if daily_ai_analysis %}
            
            <!-- ç¶“é©—ç­‰ç´š & å­¸ç¿’é€²åº¦ -->
            <div style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 25px; border-radius: 12px; margin-bottom: 30px;">
                <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap;">
                    <div>
                        <h2 style="margin: 0; font-size: 1.8rem;">{{ daily_ai_analysis.level_icon }} AI äº¤æ˜“å“¡åˆ†æ</h2>
                        <p style="margin: 8px 0 0 0; opacity: 0.9;">ç¶“é©—ç­‰ç´š: {{ daily_ai_analysis.experience_level }}</p>
                    </div>
                    <div style="text-align: right; background: rgba(255,255,255,0.1); padding: 15px 20px; border-radius: 8px; backdrop-filter: blur(10px);">
                        <div style="font-size: 0.9rem; opacity: 0.9; margin-bottom: 5px;">å­¸ç¿’é€²åº¦</div>
                        <div style="font-size: 1.1rem; font-weight: 600;">{{ daily_ai_analysis.learning_summary }}</div>
                    </div>
                </div>
            </div>

            <!-- é—œéµå¸‚å ´æ•¸æ“š -->
            <div class="grid" style="margin-bottom: 30px;">
                <div class="card">
                    <div class="card-title">æ”¶ç›¤åƒ¹</div>
                    <div class="card-value">{{ "{:,.0f}".format(daily_ai_analysis.key_data.close_price) }}</div>
                </div>
                <div class="card">
                    <div class="card-title">PC Ratio</div>
                    <div class="card-value">{{ "{:.3f}".format(daily_ai_analysis.key_data.pc_ratio) }}</div>
                </div>
                <div class="card">
                    <div class="card-title">å¸‚å ´æƒ…ç·’</div>
                    <div class="card-value" style="font-size: 1.3rem;">{{ market_sentiment }}</div>
                </div>
                <div class="card">
                    <div class="card-title">è¶¨å‹¢ä¿¡è™Ÿ</div>
                    <div class="card-value" style="font-size: 1.3rem;">
                        {% if daily_ai_analysis.key_data.trend_signal == 'bullish' %}
                        ğŸ“ˆ åå¤š
                        {% elif daily_ai_analysis.key_data.trend_signal == 'bearish' %}
                        ğŸ“‰ åç©º
                        {% else %}
                        â¡ï¸ ä¸­æ€§
                        {% endif %}
                    </div>
                </div>
            </div>

            <!-- å¸‚å ´è§€å¯Ÿï¼ˆç¬¬ä¸€äººç¨±ï¼‰ -->
            <div class="ai-section">
                <h2 class="analysis-title">ğŸ‘ï¸ æˆ‘ä»Šå¤©çš„å¸‚å ´è§€å¯Ÿ</h2>
                <div style="background: white; padding: 25px; border-radius: 12px; border-left: 4px solid var(--primary-color); box-shadow: var(--shadow); line-height: 1.8; white-space: pre-wrap;">{{ daily_ai_analysis.market_observation }}</div>
            </div>

            <!-- éƒ¨ä½ç­–ç•¥ï¼ˆç¬¬ä¸€äººç¨±ï¼‰ -->
            <div class="ai-section">
                <h2 class="analysis-title">ğŸ’¼ æˆ‘çš„éƒ¨ä½ç­–ç•¥</h2>
                <div style="background: white; padding: 25px; border-radius: 12px; border-left: 4px solid #10b981; box-shadow: var(--shadow); line-height: 1.8; white-space: pre-wrap;">{{ daily_ai_analysis.position_strategy }}</div>
            </div>

            <!-- é¢¨éšªè©•ä¼°ï¼ˆç¬¬ä¸€äººç¨±ï¼‰ -->
            <div class="ai-section">
                <h2 class="analysis-title">âš ï¸ æˆ‘çš„é¢¨éšªè©•ä¼°</h2>
                <div style="background: #fef2f2; padding: 25px; border-radius: 12px; border-left: 4px solid #ef4444; box-shadow: var(--shadow); line-height: 1.8; white-space: pre-wrap;">{{ daily_ai_analysis.risk_assessment }}</div>
            </div>

            <!-- äº¤æ˜“è¨ˆåŠƒï¼ˆç¬¬ä¸€äººç¨±ï¼‰ -->
            <div class="ai-section">
                <h2 class="analysis-title">ğŸ“‹ æˆ‘çš„äº¤æ˜“è¨ˆåŠƒ</h2>
                <div style="background: white; padding: 25px; border-radius: 12px; border-left: 4px solid #f59e0b; box-shadow: var(--shadow); line-height: 1.8; white-space: pre-wrap;">{{ daily_ai_analysis.trading_plan }}</div>
            </div>

            <!-- æ­·å²æ´å¯Ÿ -->
            {% if daily_ai_analysis.historical_insights %}
            <div class="ai-section">
                <h2 class="analysis-title">ğŸ“š å¾éå»ç¶“é©—å­¸åˆ°çš„</h2>
                <div class="grid">
                    {% for insight in daily_ai_analysis.historical_insights %}
                    <div class="card" style="background: linear-gradient(135deg, #fef3c7, #fde68a);">
                        <p style="margin: 0; font-style: italic;">ğŸ’¡ {{ insight }}</p>
                    </div>
                    {% endfor %}
                </div>
            </div>
            {% endif %}

            <!-- ç›¸ä¼¼æ¡ˆä¾‹åƒè€ƒ -->
            {% if daily_ai_analysis.similar_cases > 0 %}
            <div style="margin-top: 20px; padding: 20px; background: #f0fdf4; border-radius: 12px; border: 1px solid #86efac;">
                <p style="margin: 0; color: #166534;">
                    ğŸ“Š åœ¨æˆ‘çš„è¨˜æ†¶ä¸­ï¼Œæ‰¾åˆ° <strong>{{ daily_ai_analysis.similar_cases }}</strong> å€‹é¡ä¼¼çš„å¸‚å ´æƒ…å¢ƒå¯ä¾›åƒè€ƒ
                </p>
            </div>
            {% endif %}

            <div style="margin-top: 30px; padding: 20px; background: linear-gradient(135deg, #f3f4f6, #e5e7eb); border-radius: 12px; text-align: center;">
                <p style="font-style: italic; color: var(--text-muted);">
                    ğŸ§‘â€ğŸ’¼ ä»¥ä¸Šæ˜¯æˆ‘ä½œç‚º AI äº¤æ˜“å“¡çš„å€‹äººè§€é»èˆ‡è¨ˆåŠƒ<br>
                    æˆ‘æœƒæŒçºŒå­¸ç¿’ä¸¦æ”¹é€²åˆ†æèƒ½åŠ›ï¼Œæ¯ä¸€æ¬¡åˆ†æéƒ½æœƒè¢«è¨˜éŒ„ä¸‹ä¾†
                </p>
            </div>

            {% else %}
            <!-- å¦‚æœæ²’æœ‰æ¯æ—¥AIåˆ†æï¼Œå‰‡ä¿ç•™åŸå§‹AIåˆ†æ -->
            {% if ai_analysis %}
            
            <!-- å¸‚å ´çµæ§‹åˆ†æ -->
            <div class="ai-section">
                <h2 class="analysis-title">ğŸ§  {{ ai_analysis.market_structure.title }}</h2>
                <div class="ai-observation-list">
                    {% for obs in ai_analysis.market_structure.observations %}
                    <li>
                        <strong style="color: var(--primary-color);">{{ obs.point }}</strong><br>
                        {{ obs.detail }}
                    </li>
                    {% endfor %}
                </div>
            </div>

            <!-- ç±Œç¢¼åˆ†å¸ƒ -->
            <div class="ai-section">
                <h2 class="analysis-title">ğŸ“¦ {{ ai_analysis.oi_analysis.title }}</h2>
                {% for feature in ai_analysis.oi_analysis.features %}
                <div class="ai-field">
                    <span class="ai-field-label">{{ feature.level }} - {{ feature.characteristic }}</span>
                    <div class="ai-field-content">{{ feature.detail }}</div>
                </div>
                {% endfor %}
            </div>

            <!-- é—œéµåƒ¹ä½ -->
            <div class="ai-section">
                <h2 class="analysis-title">ğŸ¯ é—œéµåƒ¹ä½è­˜åˆ¥</h2>
                <div class="grid">
                    <div class="card">
                        <h3 style="color: var(--put-color);">é—œéµæ”¯æ’</h3>
                        {% for support in ai_analysis.key_levels.critical_support %}
                        <div class="ai-field">
                            <span class="ai-key-level">{{ "{:,}".format(support.price) }} é»</span>
                            <span class="badge" style="background: var(--put-color); color: white; padding: 4px 8px; border-radius: 4px; margin-left: 8px;">
                                {{ support.strength }}
                            </span>
                            <div style="margin-top: 8px; font-size: 0.9rem;">{{ support.reason }}</div>
                        </div>
                        {% endfor %}
                    </div>
                    
                    <div class="card">
                        <h3 style="color: var(--primary-color);">æ¨ç´å€åŸŸ</h3>
                        {% for pivot in ai_analysis.key_levels.pivot_zones %}
                        <div class="ai-field">
                            <span class="ai-key-level">{{ "{:,}".format(pivot.price) }} é»</span>
                            <span class="badge" style="background: var(--primary-color); color: white; padding: 4px 8px; border-radius: 4px; margin-left: 8px;">
                                {{ pivot.role }}
                            </span>
                            <div style="margin-top: 8px; font-size: 0.9rem;">ç£å¸åŠ›: {{ pivot.magnet }}</div>
                        </div>
                        {% endfor %}
                    </div>
                    
                    <div class="card">
                        <h3 style="color: var(--call-color);">é—œéµå£“åŠ›</h3>
                        {% for resist in ai_analysis.key_levels.critical_resistance %}
                        <div class="ai-field">
                            <span class="ai-key-level">{{ "{:,}".format(resist.price) }} é»</span>
                            <span class="badge" style="background: var(--call-color); color: white; padding: 4px 8px; border-radius: 4px; margin-left: 8px;">
                                {{ resist.strength }}
                            </span>
                            <div style="margin-top: 8px; font-size: 0.9rem;">{{ resist.reason }}</div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>

            <!-- AI æƒ…å¢ƒåˆ†æ -->
            <h2 class="section-title" style="margin-top: 40px;">ğŸ² AI æ·±åº¦æƒ…å¢ƒæ¨æ¼”</h2>
            {% for scenario in ai_analysis.scenarios %}
            <div class="ai-scenario-card">
                <div class="ai-scenario-header">
                    <h3 class="ai-scenario-title">{{ scenario.title }}</h3>
                    <span class="ai-probability">æ©Ÿç‡: {{ scenario.probability }}</span>
                </div>
                
                <div class="ai-field">
                    <span class="ai-field-label">ğŸ¯ ç›®æ¨™å€é–“</span>
                    <div class="ai-field-content" style="font-size: 1.2rem; font-weight: 700; color: var(--primary-color);">
                        {{ scenario.target_range }}
                    </div>
                </div>
                
                <div class="ai-field">
                    <span class="ai-field-label">ğŸ”‘ é€²å ´æ¢ä»¶</span>
                    <div class="ai-field-content">{{ scenario.entry_condition }}</div>
                </div>
                
                <div class="ai-field">
                    <span class="ai-field-label">ğŸ“ˆ åƒ¹æ ¼è¡Œç‚º</span>
                    <div class="ai-field-content">{{ scenario.price_action }}</div>
                </div>
                
                <div class="ai-field" style="background: #fef9f3;">
                    <span class="ai-field-label">{{ scenario.key_observation.split(':')[0] }}</span>
                    <div class="ai-field-content">{{ scenario.key_observation.split('ğŸ“Œ')[1] if 'ğŸ“Œ' in scenario.key_observation else scenario.key_observation }}</div>
                </div>
                
                <div class="ai-field">
                    <span class="ai-field-label">ğŸ® èŠå®¶ç­–ç•¥</span>
                    <div class="ai-field-content">{{ scenario.dealer_strategy }}</div>
                </div>
                
                <div class="ai-field">
                    <span class="ai-field-label">âš–ï¸ é¢¨éšªå ±é…¬</span>
                    <div class="ai-field-content">{{ scenario.risk_reward }}</div>
                </div>
                
                <div class="ai-field">
                    <span class="ai-field-label">â° æ™‚é–“æ¡†æ¶</span>
                    <div class="ai-field-content">{{ scenario.time_frame }}</div>
                </div>
            </div>
            {% endfor %}

            <!-- ç›¤ä¸­è§€å¯Ÿé‡é» -->
            <div class="ai-section" style="margin-top: 30px;">
                <h2 class="analysis-title">â° {{ ai_analysis.intraday_watch.title }}</h2>
                
                <h3 style="margin-top: 20px; color: var(--primary-color);">æ™‚æ®µè§€å¯Ÿ</h3>
                {% for watch in ai_analysis.intraday_watch.time_based %}
                <div class="ai-field">
                    <span class="ai-field-label">{{ watch.time }} - {{ watch.watch }}</span>
                    <div class="ai-field-content">{{ watch.detail }}</div>
                </div>
                {% endfor %}
                
                <h3 style="margin-top: 20px; color: var(--primary-color);">åƒ¹ä½è­¦ç¤º</h3>
                <div class="grid">
                    {% for alert in ai_analysis.intraday_watch.price_alerts %}
                    <div class="card" style="text-align: center;">
                        <div style="font-size: 1.5rem; font-weight: 700; color: var(--primary-color);">
                            {{ "{:,}".format(alert.level) }}
                        </div>
                        <div style="margin: 8px 0; font-weight: 600;">{{ alert.direction }}</div>
                        <div style="font-size: 0.9rem;">{{ alert.meaning }}</div>
                    </div>
                    {% endfor %}
                </div>
            </div>

            <!-- é¢¨éšªè­¦ç¤º -->
            <div class="ai-section" style="margin-top: 30px;">
                <h2 class="analysis-title">âš ï¸ {{ ai_analysis.risk_warnings.title }}</h2>
                
                {% for warning in ai_analysis.risk_warnings.warnings %}
                <div class="ai-warning">
                    <strong>{{ warning.type }}</strong><br>
                    {{ warning.detail }}
                </div>
                {% endfor %}
                
                <h3 style="margin-top: 20px; color: var(--primary-color);">ğŸ’¡ æ“ä½œå»ºè­°</h3>
                {% for rec in ai_analysis.risk_warnings.recommendations %}
                <div class="ai-recommendation">
                    {{ rec }}
                </div>
                {% endfor %}
            </div>

            <div style="margin-top: 30px; padding: 20px; background: linear-gradient(135deg, #f3f4f6, #e5e7eb); border-radius: 12px; text-align: center;">
                <p style="font-style: italic; color: var(--text-muted);">
                    âš¡ æœ¬åˆ†æç”± AI åŸºæ–¼ 2026/01/09 ç›¤å¾Œæ•¸æ“šç”Ÿæˆï¼Œåƒ…ä¾›åƒè€ƒã€‚å¯¦éš›äº¤æ˜“è«‹ä»¥ç›¤ä¸­è®ŠåŒ–èª¿æ•´ã€‚
                </p>
            </div>

            {% else %}
            <div class="card">
                <p>AI äº¤æ˜“å“¡åˆ†æåŠŸèƒ½å°šæœªå•Ÿç”¨</p>
            </div>
            {% endif %}
            
            <!-- AI é æ¸¬èˆ‡æª¢è¨å€å¡Š -->
            {% if prediction or review %}
            <div style="margin-top: 50px; padding-top: 40px; border-top: 3px solid #e2e8f0;">
                
                {% if prediction %}
                <!-- æ˜æ—¥é æ¸¬ -->
                <div style="background: linear-gradient(135deg, #fbbf24, #f59e0b); color: white; padding: 25px; border-radius: 12px; margin-bottom: 30px;">
                    <h2 style="margin: 0 0 10px 0; font-size: 1.8rem;">ğŸ”® æ˜æ—¥å¸‚å ´é æ¸¬</h2>
                    <p style="margin: 0; opacity: 0.9;">é æ¸¬æ—¥æœŸ: {{ prediction.prediction_date[:4] }}/{{ prediction.prediction_date[4:6] }}/{{ prediction.prediction_date[6:] }} â†’ {{ prediction.next_trading_day[:4] }}/{{ prediction.next_trading_day[4:6] }}/{{ prediction.next_trading_day[6:] }}</p>
                </div>
                
                <div class="ai-section">
                    <h3 class="analysis-title">ğŸ’­ å¸‚å ´å±•æœ›</h3>
                    <div style="background: white; padding: 25px; border-radius: 12px; border-left: 4px solid #fbbf24; box-shadow: var(--shadow); line-height: 1.8; white-space: pre-wrap;">{{ prediction.outlook }}</div>
                </div>
                
                <div class="grid" style="margin: 30px 0;">
                    <div class="card">
                        <h3 style="color: var(--primary-color);">æ–¹å‘é æ¸¬</h3>
                        <div style="font-size: 2rem; font-weight: 700; margin: 15px 0;">
                            {% if prediction.direction_prediction.direction == 'çœ‹æ¼²' %}
                            ğŸ“ˆ {{ prediction.direction_prediction.direction }}
                            {% elif prediction.direction_prediction.direction == 'çœ‹è·Œ' %}
                            ğŸ“‰ {{ prediction.direction_prediction.direction }}
                            {% else %}
                            â¡ï¸ {{ prediction.direction_prediction.direction }}
                            {% endif %}
                        </div>
                        <div style="font-size: 1.2rem; color: var(--text-muted);">
                            æ©Ÿç‡: {{ prediction.direction_prediction.probability }}%
                        </div>
                        <div style="margin-top: 10px; font-size: 0.9rem;">
                            {{ prediction.direction_prediction.reasoning }}
                        </div>
                    </div>
                    
                    <div class="card">
                        <h3 style="color: var(--primary-color);">é æ¸¬å€é–“</h3>
                        <div style="margin: 15px 0;">
                            <div style="font-size: 0.9rem; color: var(--text-muted);">ä¸Šç•Œ</div>
                            <div style="font-size: 1.3rem; font-weight: 600; color: var(--call-color);">
                                {{ "{:,}".format(prediction.range_prediction.upper_bound) }}
                            </div>
                        </div>
                        <div style="margin: 15px 0; padding: 10px; background: #f3f4f6; border-radius: 8px;">
                            <div style="font-size: 0.9rem; color: var(--text-muted);">ç¾åƒ¹</div>
                            <div style="font-size: 1.5rem; font-weight: 700;">
                                {{ "{:,}".format(prediction.range_prediction.current) }}
                            </div>
                        </div>
                        <div style="margin: 15px 0;">
                            <div style="font-size: 0.9rem; color: var(--text-muted);">ä¸‹ç•Œ</div>
                            <div style="font-size: 1.3rem; font-weight: 600; color: var(--put-color);">
                                {{ "{:,}".format(prediction.range_prediction.lower_bound) }}
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <h3 style="color: var(--primary-color);">ä¿¡å¿ƒæ°´æº–</h3>
                        <div style="font-size: 3rem; font-weight: 700; margin: 20px 0; color: var(--primary-color);">
                            {{ prediction.confidence_level }}%
                        </div>
                        <div style="font-size: 0.9rem; color: var(--text-muted);">
                            ç¶“é©—ç­‰ç´š: {{ prediction.experience_level[0] }} {{ prediction.experience_level[1] }}
                        </div>
                    </div>
                </div>
                
                <div class="ai-section">
                    <h3 class="analysis-title">ğŸ¯ ç­–ç•¥å»ºè­°</h3>
                    <div class="grid">
                        <div class="card">
                            <h4 style="color: var(--primary-color);">ä¸»è¦ç­–ç•¥</h4>
                            <div style="font-size: 1.2rem; font-weight: 600; margin: 10px 0;">
                                {{ prediction.strategy_recommendation.primary }}
                            </div>
                        </div>
                        <div class="card">
                            <h4 style="color: var(--primary-color);">æ›¿ä»£æ–¹æ¡ˆ</h4>
                            <div style="font-size: 1.2rem; font-weight: 600; margin: 10px 0;">
                                {{ prediction.strategy_recommendation.alternative }}
                            </div>
                        </div>
                        <div class="card">
                            <h4 style="color: var(--primary-color);">é€²å ´æ™‚æ©Ÿ</h4>
                            <div style="font-size: 1rem; margin: 10px 0;">
                                {{ prediction.strategy_recommendation.entry_timing }}
                            </div>
                        </div>
                        <div class="card">
                            <h4 style="color: var(--call-color);">åœæé»</h4>
                            <div style="font-size: 1rem; margin: 10px 0; color: var(--call-color); font-weight: 600;">
                                {{ prediction.strategy_recommendation.stop_loss }}
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="ai-section">
                    <h3 class="analysis-title">âš ï¸ é¢¨éšªè­¦å‘Š</h3>
                    <div style="background: #fef3c7; border-left: 4px solid #f59e0b; padding: 20px; border-radius: 8px; white-space: pre-wrap;">{{ prediction.risk_warning }}</div>
                </div>
                {% endif %}
                
                {% if review %}
                <!-- ç›¤å¾Œæª¢è¨ -->
                <div style="background: linear-gradient(135deg, #8b5cf6, #6366f1); color: white; padding: 25px; border-radius: 12px; margin: 50px 0 30px 0;">
                    <h2 style="margin: 0 0 10px 0; font-size: 1.8rem;">ğŸ“ ç›¤å¾Œæª¢è¨å ±å‘Š</h2>
                    <p style="margin: 0; opacity: 0.9;">é æ¸¬æ—¥: {{ review.prediction_date[:4] }}/{{ review.prediction_date[4:6] }}/{{ review.prediction_date[6:] }} | å¯¦éš›æ—¥: {{ review.actual_date[:4] }}/{{ review.actual_date[4:6] }}/{{ review.actual_date[6:] }}</p>
                </div>
                
                <div class="grid" style="margin-bottom: 30px;">
                    <div class="card" style="text-align: center;">
                        <h4 style="color: var(--text-muted); margin-bottom: 10px;">æº–ç¢ºåº¦</h4>
                        <div style="font-size: 3rem; font-weight: 700; 
                            {% if review.accuracy.overall_accuracy >= 80 %}color: #10b981;
                            {% elif review.accuracy.overall_accuracy >= 60 %}color: #3b82f6;
                            {% elif review.accuracy.overall_accuracy >= 40 %}color: #f59e0b;
                            {% else %}color: #ef4444;{% endif %}">
                            {{ review.accuracy.overall_accuracy }}%
                        </div>
                    </div>
                    <div class="card" style="text-align: center;">
                        <h4 style="color: var(--text-muted); margin-bottom: 10px;">è©•åˆ†</h4>
                        <div style="font-size: 2rem; font-weight: 700; margin-top: 15px;">
                            {{ review.score }}
                        </div>
                    </div>
                    <div class="card" style="text-align: center;">
                        <h4 style="color: var(--text-muted); margin-bottom: 10px;">æ–¹å‘é æ¸¬</h4>
                        <div style="font-size: 2.5rem; margin-top: 10px;">
                            {% if review.accuracy.direction_correct %}
                            âœ… æ­£ç¢º
                            {% else %}
                            âŒ éŒ¯èª¤
                            {% endif %}
                        </div>
                    </div>
                    <div class="card" style="text-align: center;">
                        <h4 style="color: var(--text-muted); margin-bottom: 10px;">åƒ¹æ ¼èª¤å·®</h4>
                        <div style="font-size: 1.5rem; font-weight: 700; margin-top: 10px;">
                            {{ review.accuracy.price_error }} é»
                        </div>
                        <div style="font-size: 1rem; color: var(--text-muted); margin-top: 5px;">
                            ({{ review.accuracy.price_error_percent }}%)
                        </div>
                    </div>
                </div>
                
                <div class="ai-section">
                    <h3 class="analysis-title">ğŸ’­ è‡ªæˆ‘åæ€</h3>
                    <div style="background: white; padding: 25px; border-radius: 12px; border-left: 4px solid #8b5cf6; box-shadow: var(--shadow); line-height: 1.8; white-space: pre-wrap;">{{ review.self_reflection }}</div>
                </div>
                
                <div class="ai-section">
                    <h3 class="analysis-title">ğŸ“š å­¸åˆ°çš„æ•™è¨“</h3>
                    <div style="background: #fef3c7; padding: 20px; border-radius: 12px; border-left: 4px solid #f59e0b;">
                        {% for lesson in review.lessons_learned %}
                        <div style="padding: 10px 0; {% if not loop.last %}border-bottom: 1px solid #fbbf24;{% endif %}">
                            <strong style="color: #f59e0b;">ğŸ’¡</strong> {{ lesson }}
                        </div>
                        {% endfor %}
                    </div>
                </div>
                
                <div class="ai-section">
                    <h3 class="analysis-title">ğŸ¯ æ”¹é€²æ–¹å‘</h3>
                    <div style="background: #dbeafe; padding: 20px; border-radius: 12px; border-left: 4px solid #3b82f6;">
                        {% for improvement in review.improvement_areas %}
                        <div style="padding: 10px 0; {% if not loop.last %}border-bottom: 1px solid #93c5fd;{% endif %}">
                            {{ improvement }}
                        </div>
                        {% endfor %}
                    </div>
                </div>
                
                <div class="grid" style="margin-top: 30px;">
                    <div class="card">
                        <h4 style="color: var(--text-muted);">é æ¸¬æ™‚æ•¸æ“š</h4>
                        <div style="margin-top: 10px;">
                            <div style="font-size: 0.9rem; color: var(--text-muted);">å°æŒ‡æœŸè²¨</div>
                            <div style="font-size: 1.3rem; font-weight: 600;">{{ "{:,}".format(review.prediction.current_metrics.tx_close) }}</div>
                        </div>
                        <div style="margin-top: 10px;">
                            <div style="font-size: 0.9rem; color: var(--text-muted);">PC Ratio</div>
                            <div style="font-size: 1.3rem; font-weight: 600;">{{ review.prediction.current_metrics.pc_ratio }}</div>
                        </div>
                    </div>
                    <div class="card">
                        <h4 style="color: var(--text-muted);">å¯¦éš›æ•¸æ“š</h4>
                        <div style="margin-top: 10px;">
                            <div style="font-size: 0.9rem; color: var(--text-muted);">å°æŒ‡æœŸè²¨</div>
                            <div style="font-size: 1.3rem; font-weight: 600;">{{ "{:,}".format(review.actual_result.tx_close) }}</div>
                        </div>
                        <div style="margin-top: 10px;">
                            <div style="font-size: 0.9rem; color: var(--text-muted);">PC Ratio</div>
                            <div style="font-size: 1.3rem; font-weight: 600;">{{ review.actual_result.pc_ratio }}</div>
                        </div>
                    </div>
                </div>
                {% endif %}
                
            </div>
            {% endif %}
            
            {% endif %}
        </div>
        <!-- çµæŸ AI åˆ†æ Tab -->

        <footer style="margin-top: 30px;">
            <p>å ±å‘Šç”¢ç”Ÿæ™‚é–“: {{ generated_at }} | TAIEX Options Analyzer</p>
        </footer>
    </div>

    <script>
        // Tab åˆ‡æ›åŠŸèƒ½
        function switchTab(event, tabId) {
            // éš±è—æ‰€æœ‰ tab å…§å®¹
            const tabContents = document.getElementsByClassName('tab-content');
            for (let content of tabContents) {
                content.classList.remove('active');
            }
            
            // ç§»é™¤æ‰€æœ‰ tab æŒ‰éˆ•çš„ active ç‹€æ…‹
            const tabButtons = document.getElementsByClassName('tab-button');
            for (let button of tabButtons) {
                button.classList.remove('active');
            }
            
            // é¡¯ç¤ºé¸ä¸­çš„ tab
            document.getElementById(tabId).classList.add('active');
            event.currentTarget.classList.add('active');
        }

        // OI åˆ†å¸ƒæ”¹ç‚ºè¡¨æ ¼å‘ˆç¾ï¼Œä¸ä½¿ç”¨ Plotly åœ–è¡¨
        /*
        // OI åˆ†å¸ƒåœ– - æ°´å¹³å°ç¨±å¼ (å±¥ç´„åƒ¹åœ¨ä¸­é–“)
        const oiData = {{ oi_chart_data | safe }};
        const maxPain = {{ max_pain }};
        const closePrice = {{ tx_data.close }};

        // éæ¿¾å‡ºæœ‰æ„ç¾©çš„å±¥ç´„åƒ¹ï¼ˆOI > 0 çš„åƒ¹ä½ï¼‰
        const filteredIndices = oiData.strikes.map((strike, idx) => {
            const totalOI = oiData.call_oi[idx] + oiData.put_oi[idx];
            return totalOI > 0 ? idx : -1;
        }).filter(idx => idx !== -1);

        const filteredStrikes = filteredIndices.map(idx => oiData.strikes[idx]);
        const filteredCallOI = filteredIndices.map(idx => oiData.call_oi[idx]);
        const filteredPutOI = filteredIndices.map(idx => oiData.put_oi[idx]);

        // æ‰¾å‡ºé—œéµåƒ¹ä½
        const maxCallOIStrike = oiData.strikes[oiData.call_oi.indexOf(Math.max(...oiData.call_oi))];
        const maxPutOIStrike = oiData.strikes[oiData.put_oi.indexOf(Math.max(...oiData.put_oi))];

        // Call å‘å·¦å»¶ä¼¸ (è² å€¼ï¼Œç´…è‰²)ï¼ŒPut å‘å³å»¶ä¼¸ (æ­£å€¼ï¼Œç¶ è‰²)
        const callTrace = {
            y: filteredStrikes,
            x: filteredCallOI.map(v => -v),
            name: 'Call',
            type: 'bar',
            orientation: 'h',
            marker: {
                color: filteredStrikes.map(strike => 
                    strike === maxCallOIStrike ? '#dc2626' : '#ef4444'
                ),
                line: { color: '#dc2626', width: 0.5 }
            },
            text: filteredCallOI.map(v => v > 0 ? v.toLocaleString() : ''),
            textposition: 'inside',
            insidetextanchor: 'end',
            textfont: { color: 'white', size: 10, weight: 'bold' },
            hovertemplate: '<b>Call OI</b><br>å±¥ç´„åƒ¹: %{y}<br>æœªå¹³å€‰: %{customdata:,} å£<extra></extra>',
            customdata: filteredCallOI
        };

        const putTrace = {
            y: filteredStrikes,
            x: filteredPutOI,
            name: 'Put',
            type: 'bar',
            orientation: 'h',
            marker: {
                color: filteredStrikes.map(strike => 
                    strike === maxPutOIStrike ? '#16a34a' : '#22c55e'
                ),
                line: { color: '#16a34a', width: 0.5 }
            },
            text: filteredPutOI.map(v => v > 0 ? v.toLocaleString() : ''),
            textposition: 'inside',
            insidetextanchor: 'start',
            textfont: { color: 'white', size: 10, weight: 'bold' },
            hovertemplate: '<b>Put OI</b><br>å±¥ç´„åƒ¹: %{y}<br>æœªå¹³å€‰: %{x:,} å£<extra></extra>'
        };

        // æ‰¾å‡ºæœ€å¤§å€¼ä»¥è¨­å®š x è»¸ç¯„åœ
        const maxOI = Math.max(...filteredCallOI, ...filteredPutOI);
        const axisRange = Math.ceil(maxOI * 1.15);

        // å»ºç«‹æ¨™è¨˜ç·šå’Œè¨»è§£
        const shapes = [
            // Max Pain è™›ç·š
            {
                type: 'line',
                x0: -axisRange,
                x1: axisRange,
                y0: maxPain,
                y1: maxPain,
                line: { color: '#f59e0b', width: 2, dash: 'dot' }
            },
            // æ”¶ç›¤åƒ¹æ¨™è¨˜ç·š
            {
                type: 'line',
                x0: -axisRange,
                x1: axisRange,
                y0: closePrice,
                y1: closePrice,
                line: { color: '#eab308', width: 2 }
            }
        ];

        const annotations = [
            // Max Pain æ¨™ç±¤
            {
                x: 0,
                y: maxPain,
                text: ` Max Pain: ${maxPain.toLocaleString()} `,
                showarrow: false,
                xanchor: 'center',
                yanchor: 'bottom',
                bgcolor: '#f59e0b',
                font: { color: 'white', size: 11, weight: 'bold' },
                borderpad: 4
            },
            // æ”¶ç›¤åƒ¹æ¨™ç±¤
            {
                x: 0,
                y: closePrice,
                text: ` æ”¶ç›¤: ${closePrice.toLocaleString()} `,
                showarrow: false,
                xanchor: 'center',
                yanchor: 'top',
                bgcolor: '#eab308',
                font: { color: 'white', size: 11, weight: 'bold' },
                borderpad: 4
            },
            // Max Call OI ç®­é ­
            {
                x: -axisRange * 0.9,
                y: maxCallOIStrike,
                text: 'â—„',
                showarrow: false,
                font: { color: '#dc2626', size: 20, weight: 'bold' }
            },
            // Max Put OI ç®­é ­
            {
                x: axisRange * 0.9,
                y: maxPutOIStrike,
                text: 'â–º',
                showarrow: false,
                font: { color: '#16a34a', size: 20, weight: 'bold' }
            }
        ];

        const oiLayout = {
            barmode: 'relative',
            bargap: 0.15,
            xaxis: {
                title: {
                    text: 'â† Call (ç´…)    æœªå¹³å€‰é‡ (å£)    Put (ç¶ ) â†’',
                    font: { size: 13, color: '#64748b' }
                },
                range: [-axisRange, axisRange],
                tickformat: ',d',
                zeroline: true,
                zerolinewidth: 3,
                zerolinecolor: '#1f2937',
                gridcolor: '#e5e7eb',
                tickvals: [-axisRange, -Math.floor(axisRange/2), 0, Math.floor(axisRange/2), axisRange],
                ticktext: [
                    Math.floor(axisRange).toLocaleString(), 
                    Math.floor(axisRange/2).toLocaleString(), 
                    '0', 
                    Math.floor(axisRange/2).toLocaleString(), 
                    Math.floor(axisRange).toLocaleString()
                ]
            },
            yaxis: {
                title: 'å±¥ç´„åƒ¹',
                tickformat: ',d',
                tickmode: 'linear',
                dtick: 50,
                gridcolor: '#e5e7eb',
                tickfont: { size: 11 }
            },
            showlegend: false,
            margin: { t: 30, r: 60, b: 60, l: 100 },
            plot_bgcolor: '#fafafa',
            paper_bgcolor: 'white',
            shapes: shapes,
            annotations: annotations
        };

        // Plotly.newPlot('oi-chart', [callTrace, putTrace], oiLayout, {responsive: true, displayModeBar: false});
        */

        // OI è®ŠåŒ–åœ–ä½¿ç”¨ Plotly
        // å·²æ”¹ç‚ºè¡¨æ ¼å½¢å¼å‘ˆç¾ï¼Œä¸ä½¿ç”¨åœ–è¡¨
        /*
        const oiData = {{ oi_chart_data | safe }};
        
        // OI è®ŠåŒ–åœ– - åŒæ¨£æ¡ç”¨è´è¶åœ–æ¨£å¼ï¼Œåªé¡¯ç¤ºæœ‰è®ŠåŒ–çš„å±¥ç´„åƒ¹
        const filteredChangeIndices = oiData.strikes.map((strike, idx) => {
            const totalChange = Math.abs(oiData.call_oi_change[idx]) + Math.abs(oiData.put_oi_change[idx]);
            return totalChange > 0 ? idx : -1;
        }).filter(idx => idx !== -1);

        const filteredChangeStrikes = filteredChangeIndices.map(idx => oiData.strikes[idx]);
        const filteredCallChange = filteredChangeIndices.map(idx => oiData.call_oi_change[idx]);
        const filteredPutChange = filteredChangeIndices.map(idx => oiData.put_oi_change[idx]);

        const callChangeTrace = {
            y: filteredChangeStrikes,
            x: filteredCallChange.map(v => -v),
            name: 'Call OI è®ŠåŒ–',
            type: 'bar',
            orientation: 'h',
            marker: {
                color: filteredCallChange.map(v => 
                    v > 0 ? '#fca5a5' :  // å¢åŠ ï¼ˆæ·¡ç´…ï¼‰
                    v < 0 ? '#dc2626' :  // æ¸›å°‘ï¼ˆæ·±ç´…ï¼‰
                    '#e5e7eb'             // ç„¡è®ŠåŒ–ï¼ˆç°ï¼‰
                ),
                line: { color: '#dc2626', width: 0.5 }
            },
            text: filteredCallChange.map(v => v !== 0 ? (v > 0 ? '+' : '') + v.toLocaleString() : ''),
            textposition: 'inside',
            insidetextanchor: 'end',
            textfont: { color: 'white', size: 9, weight: 'bold' },
            hovertemplate: '<b>Call OI è®ŠåŒ–</b><br>å±¥ç´„åƒ¹: %{y}<br>è®ŠåŒ–: %{customdata:+,} å£<extra></extra>',
            customdata: filteredCallChange
        };

        const putChangeTrace = {
            y: filteredChangeStrikes,
            x: filteredPutChange,
            name: 'Put OI è®ŠåŒ–',
            type: 'bar',
            orientation: 'h',
            marker: {
                color: filteredPutChange.map(v => 
                    v > 0 ? '#86efac' :  // å¢åŠ ï¼ˆæ·¡ç¶ ï¼‰
                    v < 0 ? '#16a34a' :  // æ¸›å°‘ï¼ˆæ·±ç¶ ï¼‰
                    '#e5e7eb'             // ç„¡è®ŠåŒ–ï¼ˆç°ï¼‰
                ),
                line: { color: '#16a34a', width: 0.5 }
            },
            text: filteredPutChange.map(v => v !== 0 ? (v > 0 ? '+' : '') + v.toLocaleString() : ''),
            textposition: 'inside',
            insidetextanchor: 'start',
            textfont: { color: 'white', size: 9, weight: 'bold' },
            hovertemplate: '<b>Put OI è®ŠåŒ–</b><br>å±¥ç´„åƒ¹: %{y}<br>è®ŠåŒ–: %{x:+,} å£<extra></extra>'
        };

        const maxChange = Math.max(
            ...filteredCallChange.map(Math.abs),
            ...filteredPutChange.map(Math.abs)
        );
        const changeRange = Math.ceil(maxChange * 1.25);

        const changeLayout = {
            barmode: 'relative',
            bargap: 0.15,
            xaxis: {
                title: {
                    text: 'â† Call å¢æ¸›    OI è®ŠåŒ– (å£)    Put å¢æ¸› â†’',
                    font: { size: 13, color: '#64748b' }
                },
                range: [-changeRange, changeRange],
                tickformat: '+,d',
                zeroline: true,
                zerolinewidth: 3,
                zerolinecolor: '#1f2937',
                gridcolor: '#e5e7eb'
            },
            yaxis: {
                title: 'å±¥ç´„åƒ¹',
                tickformat: ',d',
                tickmode: 'linear',
                dtick: 50,
                gridcolor: '#e5e7eb',
                tickfont: { size: 11 }
            },
            showlegend: false,
            margin: { t: 30, r: 60, b: 60, l: 100 },
            plot_bgcolor: '#fafafa',
            paper_bgcolor: 'white'
        };

        // Plotly.newPlot('oi-change-chart', [callChangeTrace, putChangeTrace], changeLayout, {responsive: true, displayModeBar: false});
        */
    </script>
</body>
</html>
